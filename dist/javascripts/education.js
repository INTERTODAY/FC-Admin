"use strict";requirejs(["common"],function(t){function e(){var t=d.find("option:selected").val(),e=d.find("option:selected").text(),a="",i=$('.list-group-item[data-course-id="'+t+'" ]');if(i.length)return i.show(),!1;a+='<li class="list-group-item" data-course-id="'+t+'">',a+='    <div class="course">',a+='        <span class="handle ui-sortable-handle">',a+='            <i class="fa fa-ellipsis-v"></i>',a+='            <i class="fa fa-ellipsis-v"></i>',a+="        </span>",a+=e,a+='        <a href="#" class="btn-delete-course">',a+='            <i class="fa fa-remove text-red"></i>',a+="        </a>",a+="    </div>",a+="</li>",r.append(a)}function a(t){t.remove()}function i(){var t=[],e=0,a=0;return $("#draggablePanelList").find("li.list-group-item").each(function(i){var n={course_id:$(this).data("course-id"),order:e};n.id?$(this).is(":visible")?n.mode="UPDATE":n.mode="DELETE":n.mode="INSERT",t.push(n),"DELETE"!==n.mode&&(a+=1,e+=1)}),{data:t,valid_course_count:a}}var n=$(".btn-add-course-edu"),d=$("#select-course-list"),r=$("#draggablePanelList"),o=$(".btn-register-course-submit");$(function(){var e=moment().format(),a=moment().add(6,"days");$("#start_dt").datetimepicker({defaultDate:e,format:"YYYY-MM-DD",showTodayButton:!0}),$("#end_dt").datetimepicker({defaultDate:a,format:"YYYY-MM-DD",useCurrent:!1,showTodayButton:!0}),$("#start_dt").on("dp.change",function(t){$("#end_dt").data("DateTimePicker").minDate(t.date)}),$("#end_dt").on("dp.change",function(t){$("#start_dt").data("DateTimePicker").maxDate(t.date)}),t.initDataTable($("#table_education")),$("#draggablePanelList").sortable({placeholder:"sort-highlight",handle:".handle",forcePlaceholderSize:!0,zIndex:999999,start:function(t,e){$(this).attr("data-previndex",e.item.index())},update:function(t,e){var a=e.item.index(),i=$(this).attr("data-previndex");$(this).removeAttr("data-previndex"),console.log("newIndex : "+a+" oldIndex : "+i)}})}),n.bind("click",function(){e()}),r.on("click","> li",function(t){a($(t.target).parent().parent().parent())}),$(".btn-delete-course").bind("click",function(){a($(this).parent().parent())}),o.bind("click",function(t){t.preventDefault();var e=($("#frm_register_edu"),$(".course-name")),a=tinymce.activeEditor.getContent(),n=i();return""===e.val()?(alert("교육과정명을 입력하세요."),e.focus(),!1):""===a?(alert("교육과정 소개를 입력해주세요."),a.focus(),!1):n.valid_course_count?!!confirm("등록하시겠습니까?")&&void axios({method:"post",url:"/education/create/edu",data:{name:e.val().trim(),desc:a,course_group_list:n.data,start_dt:$("#start_dt").find("input").val()+" 00:00:00",end_dt:$("#end_dt").find("input").val()+" 23:59:59"}}).then(function(t){1==t.data.success?alert("교육과정을 등록하였습니다."):alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요."),window.location.reload()}):(alert("강의를 추가해주세요."),!1)})});