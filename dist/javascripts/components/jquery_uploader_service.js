"use strict";window.define(["common","jquery.iframe-transport","jquery-ui/ui/widget","jquery.fileupload"],function(o){function n(o){t=this,t.extendOptions(o),t.init()}var t,e,a=a||window.$,i=i||window.axios;return n.prototype={options:{},extend:function(o,n){for(var t in n)n.hasOwnProperty(t)&&(o[t]=n[t]);return o},extendOptions:function(o){this.options=this.extend({},this.options),this.extend(this.options,o)},init:function(){t.getUploadInfo(),a("#cancel-button").attr("disabled",!0)},getUploadInfo:function(){i.get("/api/v1/fineuploader/token").then(function(o){var n=o.data.uploadInfo;n&&(t.options.uploadUrl=n.uploadUrl.replace("v4","cdnovp"),t.options.uploadCancelUrl=n.uploadCancelUrl,t.options.token=n.token,t.setJqueryFileUploader())})},cancelUpload:function(){i.post(t.options.uploadCancelUrl+"?token="+t.options.token,{token:t.options.token}).then(function(o){window.alert("업로드 취소"),window.location.reload()}).catch(function(o){console.log(o)})},setJqueryFileUploader:function(){a("#fileupload").attr("data-url",t.options.uploadUrl+"?token="+t.options.token);var o=new window.FormData;o.append("token",t.options.token),o.append("folder",2004661),o.append("pkg",1006241),o.append("target_path",t.options.uploadFolder),a("#fileupload").fileupload({dataType:"json",singleFileUploads:!0,autoUpload:!1,acceptFileTypes:/(\.|\/)(mp4|avi)$/i,formData:o,replaceFileInput:!1,add:function(o,n){a("#upload-button").off("click").on("click",function(){a("#upload-button").attr("disabled",!0),a("#cancel-button").attr("disabled",!1),console.log(n),e=n.submit()})},done:function(o,n){var e=n.jqXHR.responseJSON;"None"===e.uploadInfo.errorInfo.errorCode?(window.alert("업로드 성공"),a("#fineUploader").modal("hide"),t.options.callback(n)):window.alert(e.uploadInfo.errorInfo.errorMessage),a("#upload-button").attr("disabled",!1),a("#cancel-button").attr("disabled",!0)},progressall:function(o,n){var t=parseInt(n.loaded/n.total*100,10);a("#progress-value").html(t+"%"),a("#progress .jquery-file-progress-bar").css("width",t+"%")}}),a("#fileupload").bind("fileuploadadd",function(o,n){a.each(n.files,function(o,n){a("#aqua-video-code").val("onm_"+n.name)}),a("#cancel-button").on("click",function(o){e.abort()})}),a("#fileupload").bind("fileuploadfail",function(o,n){"abort"===n.errorThrown&&t.cancelUpload()}),a("#fileupload").bind("fileuploadsubmit",function(o,n){console.log(n.formData)})}},n});
//# sourceMappingURL=../../maps/components/jquery_uploader_service.js.map
