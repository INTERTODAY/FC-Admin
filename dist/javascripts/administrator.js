"use strict";window.requirejs(["common"],function(a){function t(a){window.axios.get("/administrator/admin/offices",{params:{id:a}}).then(function(a){var t=a.data;if(t.length>0){C.prop("disabled",!1);var i=c("#table-admin-offices").DataTable();i.clear().draw(),i.rows.add(t),i.columns.adjust().draw()}else E.prop("disabled",!0)}).catch(function(a){console.error(a)})}var i,n,e,o=this,c=c||window.$,r=window.$("#select-branch-list"),d=[],s=window.$(".btn-assign-branch"),l=window.$("#draggablePanelList"),u=window.$(".btn-assign-branch-submit"),f=null,m=c(".office-right-buttons > #clear-input"),b=c(".office-right-buttons > .btn-submit"),p=c("#btnDisableOffice"),w=c("#frm-regist-office"),h=c(".branch-right-buttons > #clear-input"),v=c(".branch-right-buttons > .btn-submit"),g=c("#frm_create_branch"),k=c("#btnDisableBranch"),y=c(".duty-list > a"),_=c(".duty-right-buttons > #clear-input"),$=c(".duty-right-buttons > .btn-submit"),x=c("#frm_create_duty"),D=c("#btnDisableDuty"),T=c("#check-all-branches"),N=c("#check-all-admin-offices"),j=c("#select-office"),E=c("#btn-save-office-branches"),C=c("#btn-save-admin-offices");c(function(){E.prop("disabled",!0),C.prop("disabled",!0),c("#select-branch-list").select2(),a.initDataTable(c("#table-branch"),{buttons:[]}),i=a.initDataTable(c("#table-office-branches"),{columns:[{data:"active",render:function(a,t,i){return"display"===t?'<input type="checkbox" class="editor-active">':a},className:"dt-body-center",orderDataType:"dom-checkbox"},{data:"branch_name",className:"center"},{data:"branch_id",className:"center",visible:!1}],buttons:[],rowCallback:function(a,t){1===t.active&&window.$("input.editor-active",a).prop("checked",!0)}}),n=a.initDataTable(c("#table-admin-offices"),{columns:[{data:"active",render:function(a,t,i){return"display"===t?'<input type="checkbox" class="editor-active">':a},className:"dt-body-center",orderDataType:"dom-checkbox"},{data:"office_name",className:"center"},{data:"office_id",className:"center",visible:!1}],buttons:[],rowCallback:function(a,t){1===t.active&&window.$("input.editor-active",a).prop("checked",!0)}}),a.initDataTable(c("#table_administrator")),a.initDataTable(c("#table-office"),{buttons:[]})}),T.bind("click",function(){c(":checkbox",i.rows().nodes()).prop("checked",this.checked)}),N.bind("click",function(){c(":checkbox",n.rows().nodes()).prop("checked",this.checked)}),E.bind("click",function(){if(!window.confirm("자료를 저장하시겠습니까?"))return!1;E.prop("disabled",!0);var a=c(":checkbox:checked",i.rows({filter:"applied"}).nodes()).map(function(){return i.row(window.$(this).parents("tr")).data().branch_id}).get().join(", ");window.axios.post("/administrator/office/branches",{office_id:j.val(),branch_ids:a}).then(function(a){a.data&&(E.prop("disabled",!1),!1!==a.data.success?window.alert("자료를 저장하였습니다."):(window.alert("자료를 저장하지 못하였습니다."),console.log(a.data.message)))})}),C.bind("click",function(){if(null==e)return!1;if(!window.confirm("자료를 저장하시겠습니까?"))return!1;C.prop("disabled",!0);var a=c(":checkbox:checked",n.rows({filter:"applied"}).nodes()).map(function(){return n.row(window.$(this).parents("tr")).data().office_id}).get().join(", ");window.axios.post("/administrator/admin/offices",{admin_id:e,office_ids:a}).then(function(a){a.data&&(C.prop("disabled",!1),!1!==a.data.success?window.alert("자료를 저장하였습니다."):(window.alert("자료를 저장하지 못하였습니다."),console.log(a.data.message)))})}),j.change(function(){var a=c(this).val();window.axios.get("/administrator/offices",{params:{id:a}}).then(function(a){var t=a.data.list;if(t.length>0){E.prop("disabled",!1);var i=c("#table-office-branches").DataTable();i.clear().draw(),i.rows.add(t),i.columns.adjust().draw()}else E.prop("disabled",!0)}).catch(function(a){console.error(a)})}),c("#assignAdminOffices").on("show.bs.modal",function(a){var i=c(a.relatedTarget);e=i.data("user-id"),t(e)}),window.$("#table_administrator").on("click",".btn-delete-admin",function(){if(!window.confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:window.$(o).data("user-id")};window.axios.delete("/administrator",{params:a}).then(function(a){a.data.success?window.alert("관리자를 삭제하였습니다."):window.alert("관리자를 삭제하지 못했습니다."),window.location.reload()}).catch(function(a){console.log(a)})}),window.administrator={removeElement:function(a){return c(a).parent().parent().remove(),d=q(),!1}},window.$(".btn-modify-admininfo").bind("click",function(a){var t=window.$(a.currentTarget),i=t.attr("data-user-name"),n=t.attr("data-user-email"),e=t.attr("data-user-role"),o=t.attr("data-url"),c=window.$("#frm_modify_admin");f=t.attr("data-user-id"),c.find("#name").val(i),c.find("#email").val(n),c.find(".employee_id").val(f),c.find("#select_authority").val(e),c.attr("action",o)}),window.$(".btn-modify-role").bind("click",function(a){var t=window.$(a.currentTarget),i=t.attr("data-user-role"),n=window.$("#frm_change_admin_role");f=t.attr("data-user-id"),n.find(".user_id").val(f),n.find("#select_authority").val(i)}),window.$(".btn-add-branch").bind("click",function(a){var t=window.$(a.currentTarget),i=window.$("#frm_assign_branch");f=t.attr("data-user-id"),i.find(".user_id").val(f),window.axios({method:"get",url:"/administrator/branch/"+f}).then(function(a){a.data.success?(d=[],l.empty(),a.data.list.forEach(function(a){var t=L(a.id,a.name);l.append(t),d.push([f,a.id])})):window.alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.")})}),s.bind("click",function(){var a=r.find("option:selected").text().trim(),t=r.find("option:selected").val().trim();if(!P(t)){var i=L(t,a);l.append(i),d.push([f,t])}});var L=function(a,t){return'<li class="list-group-item" data-branch-id="'+a+'"><div class="course">'+t+'<a href="#" class="btn-delete-course" onclick="administrator.removeElement(this);"> <i class="fa fa-remove text-red"></i></a> </div></li>'},O=window.$("#draggablePanelList");O.sortable({handle:".course",update:function(){d=q()}});var P=function(a){for(var t=0,i=d.length;t<i;t++)if(d[t][1]==a)return!0;return!1},q=function(){var a=[];return window.$(".list-group-item",O).each(function(t,i){var n=[f,window.$(i).attr("data-branch-id")];a.push(n)}),a};u.bind("click",function(a){if(a.preventDefault(),d.length<=0)return void window.alert("지점을 추가하세요.");window.axios({method:"post",url:"/administrator/assign/branch",data:{user_id:f,branch_list:d}}).then(function(a){a.data.success?window.alert("지점을 배정하였습니다."):(console.log(a.data.msg),window.alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.")),window.location.reload()})}),c("#table-office").on("click",".office-list-item",function(a){a.preventDefault(),c(".office-input > input[name='id']").val(c(this).data("id")),c(".office-input > input[name='office_name']").val(c(this).data("office-name")),c(".office-input > textarea[name='office_desc']").val(c(this).data("office-desc")),w.attr("action","/administrator/modify/office"),b.html("수정"),p.prop("disabled",!1)}),m.bind("click",function(){c(".office-input > input[name='id']").val(""),c(".office-input > input[name='office_name']").val(""),c(".office-input > textarea[name='office_desc']").val(""),w.attr("action","/administrator/regist/office"),b.html("등록"),p.prop("disabled",!0)}),p.bind("click",function(){if(!window.confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".office-input > input[name='id'").val()};window.axios.delete("/administrator/office",{params:a}).then(function(a){a.data.success?window.alert("지사를 삭제하였습니다."):window.alert("지사를 삭제하지 못했습니다."),window.location.reload()}).catch(function(a){console.log(a)})}),c("#table-branch").on("click",".branch-list-item",function(a){a.preventDefault(),c(".branch-input > input[name='id']").val(c(this).data("id")),c(".branch-input > input[name='name']").val(c(this).data("name")),g.attr("action","/employee/modify/branch"),v.html("수정"),k.prop("disabled",!1)}),h.bind("click",function(){c(".branch-input > input[name='id']").val(""),c(".branch-input > input[name='name']").val(""),g.attr("action","/employee/create/branch"),v.html("등록"),k.prop("disabled",!0)}),k.bind("click",function(){if(!confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".branch-input > input[name='id'").val()};axios.delete("/employee/branch",{params:a}).then(function(a){a.data.success?alert("지점을 삭제하였습니다."):alert("지점을 삭제하지 못했습니다."),location.reload()}).catch(function(a){console.log(a)})}),y.bind("click",function(a){a.preventDefault(),c(".duty-input > input[name='id'").val(c(this).data("id")),c(".duty-input > input[name='name']").val(c(this).data("name")),x.attr("action","/employee/modify/duty"),$.html("수정"),D.prop("disabled",!1)}),_.bind("click",function(){c(".duty-input > input[name='id']").val(""),c(".duty-input > input[name='name']").val(""),x.attr("action","/employee/create/duty"),$.html("등록"),D.prop("disabled",!0)}),D.bind("click",function(){if(!confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".duty-input > input[name='id'").val()};axios.delete("/employee/duty",{params:a}).then(function(a){a.data.success?alert("직책을 삭제하였습니다."):alert("직책을 삭제하지 못했습니다."),location.reload()}).catch(function(a){console.log(a)})})});
//# sourceMappingURL=../maps/administrator.js.map
