{"version":3,"sources":["course_details.js"],"names":["window","requirejs","btnSolveQuiz","params","location","reload","catch","then","response","data","success","alert","preventDefault","error","console","log","makeSessionOrderChangeRequest","session","axios","method","url","title","changeSessionOrder","children","promises","items","index","$","length","push","all","results","forEach","btnPreviewChecklist","btnWatch","btnCreateQuiz","btnCreateFinalQuiz","btnCreateChecklist","btnModifySession","btnDeleteCourse","sortable","handle","zIndex","start","forcePlaceholderSize","update","e","ui","this","attr","item","removeAttr","winpop_listener","courseListId","Util","createWindowPopup","parent","windowOption","videoId","bind","id","href","btnCreateVideo","courseId","quizGroupId","dataTitle","dataType","btnDeleteSession","confirm","course_list_type","checklist_group_id","quiz_group_id","deleteSession","video_id","dataCourseListId","dataQuizGroupId","dataChecklistGroupId","dataCourseId","dataVideoId"],"mappings":"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","file":"course_details.js","sourcesContent":["'use strict';\nwindow.requirejs(\n  [\n    'common'\n  ],\nfunction (Util) {\n  var windowOption = 'scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, ' +\n      'resizable=yes, width=1040, height=760, left=0, top=0';\n  var btnWatch = window.$('.btn-watch-video');\n  var btnSolveQuiz = window.$('.btn-solve-quiz'); // 퀴즈/파이널테스트 보기\n  var btnPreviewChecklist = window.$('.btn-preview-checklist'); // 체크리스트 보기\n  var btnCreateVideo = window.$('.btn-create-video'); // 비디오 보기\n  // var btnModifyVideo = window.$('.btn-modify-video'); // 비디오 수정\n  var btnCreateQuiz = window.$('.btn-create-quiz'); // 퀴즈 생성\n  var btnCreateFinalQuiz = window.$('.btn-create-final'); // 파이널테스트 생성\n  var btnCreateChecklist = window.$('.btn-create-checklist'); // 파이널테스트 생성\n  var btnDeleteSession = window.$('.btn-delete-session'); // 세션 삭제버튼\n  var btnModifySession = window.$('.btn-modify-session'); // 세션 수정버튼\n  var btnDeleteCourse = window.$('#btnDeleteCourse'); // 강의 삭제 버튼\n\n  window.$(function () {\n      // jQuery UI sortable 초기화\n    window.$('.course-session').sortable({\n      placeholder: 'sort-highlight',\n      handle: '.handle',\n      forcePlaceholderSize: true,\n      zIndex: 999999,\n      start: function (e, ui) {\n        window.$(this).attr('data-previndex', ui.item.index());\n      },\n      update: function (e, ui) {\n        // var newIndex = ui.item.index();\n        // var oldIndex = window.$(this).attr('data-previndex');\n        // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n        window.$(this).removeAttr('data-previndex');\n        changeSessionOrder();\n      }\n    });\n\n    window.winpop_listener = function (data) {\n      if (data === true) {\n        window.location.reload(true);\n      }\n    };\n  });\n\n  // 체크리스트 보기\n  btnPreviewChecklist.bind('click', function (e) {\n    e.preventDefault();\n    var courseListId = window.$(this).parent('span').data('course-list-id');\n    if (!courseListId) {\n      courseListId = window.$(this).data('id');\n    }\n    Util.createWindowPopup('/course/checklist?course_list_id=' + courseListId, 'Checklist', windowOption);\n  });\n\n  // 비디오 보기\n  btnWatch.bind('click', function (e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr('data-video-id');\n    Util.createWindowPopup('/course/video?id=' + videoId, 'Video', windowOption);\n  });\n\n  // 강의 삭제하기\n  btnDeleteCourse.bind('click', function () {\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var params = {\n      id: window.$(this).data('course-id')\n    };\n\n    window.axios.delete('/course/deactivate',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('강의를 삭제하였습니다.');\n        } else {\n          window.alert('강의를 삭제하였습니다.');\n          window.location.href = '/course';\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 비디오 생성하기\n  btnCreateVideo.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/video?course_id=' + courseId, 'Video', windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  btnSolveQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr('data-quiz-group');\n    var dataTitle = window.$(this).attr('data-title');\n    var dataType = window.$(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n\n  // 퀴즈 생성하기\n  btnCreateQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=QUIZ', 'Quiz', windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateFinalQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=FINAL', 'Final', windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateChecklist.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/checklist?course_id=' + courseId + '&type=CHECK', 'Checklist', windowOption);\n  });\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession (params) {\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          window.location.reload();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 세션을 삭제한다.\n   *\n   */\n  btnDeleteSession.bind('click', function (e) {\n    e.preventDefault();\n\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var params = {};\n    params.course_list_id = window.$(this).parent('span').data('course-list-id');\n    params.course_list_type = window.$(this).parent('span').data('type');\n\n    var courselistType = window.$(this).parent('span').data('type');\n    switch (courselistType) {\n    case 'QUIZ':\n    case 'FINAL':\n      params.quiz_group_id = window.$(this).data('quiz-group');\n      break;\n    case 'VIDEO':\n      params.video_id = window.$(this).data('video-id');\n      break;\n    case 'CHECKLIST':\n      params.checklist_group_id = window.$(this).data('checklist-group');\n      break;\n    default:\n      break;\n    }\n    deleteSession(params);\n  });\n\n  /**\n   * 세션 수정하기\n   */\n  btnModifySession.bind('click', function (e) {\n    e.preventDefault();\n\n    var dataCourseId = window.$(this).parent('span').data('course-id');\n    var dataCourseListId = window.$(this).parent('span').data('course-list-id');\n    var dataVideoId = window.$(this).data('video-id');\n    var dataQuizGroupId = window.$(this).data('quiz-group');\n    var dataChecklistGroupId = window.$(this).data('checklist-group');\n    var dataType = window.$(this).parent('span').data('type'); // VIDEO/QUIZ/FINAL\n\n    if (dataType === 'VIDEO') {\n      Util.createWindowPopup('/course/modify/video?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&video_id=' + dataVideoId, 'Video', windowOption);\n    } else if (dataType === 'QUIZ' || dataType === 'FINAL') {\n      Util.createWindowPopup('/course/modify/quiz?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&quiz_group_id=' + dataQuizGroupId, 'Quiz', windowOption);\n    } else if (dataType === 'CHECKLIST') {\n      Util.createWindowPopup('/course/modify/checklist?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&checklist_group_id=' + dataChecklistGroupId, 'Checklist', windowOption);\n    }\n  });\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest (session) {\n    return window.axios({\n      method: 'put',\n      url: '/course/courselist',\n      data: {\n        title: session.children().children('a').data('title'),\n        course_list_id: session.children().children('a').data('id'),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder () {\n    var promises = [];\n    var items = window.$('.session-list');\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises).then(function (results) {\n      results.forEach(function (response) {\n      });\n    });\n  }\n});\n"],"sourceRoot":"/source/"}