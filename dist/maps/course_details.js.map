{"version":3,"sources":["course_details.js"],"names":["window","requirejs","btnWatch","data","session","title","course_list_id","course_list_order","children","index","changeSessionOrder","promises","items","$","axios","then","success","all","spread","acct","perms","alert","reload","delete","console","log","response","location","catch","error","confirm","btnSolveQuiz","btnPreviewChecklist","btnCreateQuiz","btnCreateFinalQuiz","btnCreateChecklist","btnModifySession","btnDeleteCourse","sortable","start","update","e","ui","this","attr","item","removeAttr","winpop_listener","bind","Util","courseListId","parent","preventDefault","windowOption","createWindowPopup","videoId","id","params","href","courseId","quizGroupId","dataTitle","dataType","btnDeleteSession","courselistType","course_list_type","deleteSession","video_id","dataVideoId","dataCourseId","dataQuizGroupId","dataChecklistGroupId","dataCourseListId"],"mappings":"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","file":"course_details.js","sourcesContent":["'use strict';\nwindow.requirejs(\n  [\n    'common'\n  ],\nfunction (Util) {\n  var $ = $ || window.$;\n  var windowOption = 'scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, ' +\n      'resizable=yes, width=1040, height=760, left=0, top=0';\n  var btnWatch = window.$('.btn-watch-video');\n  var btnSolveQuiz = window.$('.btn-solve-quiz'); // 퀴즈/파이널테스트 보기\n  var btnPreviewChecklist = window.$('.btn-preview-checklist'); // 체크리스트 보기\n  var btnCreateVideo = window.$('.btn-create-video'); // 비디오 보기\n  // var btnModifyVideo = window.$('.btn-modify-video'); // 비디오 수정\n  var btnCreateQuiz = window.$('.btn-create-quiz'); // 퀴즈 생성\n  var btnCreateFinalQuiz = window.$('.btn-create-final'); // 파이널테스트 생성\n  var btnCreateChecklist = window.$('.btn-create-checklist'); // 파이널테스트 생성\n  var btnDeleteSession = window.$('.btn-delete-session'); // 세션 삭제버튼\n  var btnModifySession = window.$('.btn-modify-session'); // 세션 수정버튼\n  var btnDeleteCourse = window.$('#btnDeleteCourse'); // 강의 삭제 버튼\n\n  window.$(function () {\n      // jQuery UI sortable 초기화\n    $('.list-group').sortable({\n      connectWith: '.list-group-item',\n      start: function (e, ui) {\n        $(this).attr('data-previndex', ui.item.index());\n      },\n      update: function (e, ui) {\n        // var newIndex = ui.item.index();\n        // var oldIndex = window.$(this).attr('data-previndex');\n        // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n        $(this).removeAttr('data-previndex');\n        changeSessionOrder();\n      }\n    });\n    // window.$('.course-session').sortable({\n    //   placeholder: 'sort-highlight',\n    //   handle: '.handle',\n    //   forcePlaceholderSize: true,\n    //   zIndex: 999999,\n    //   start: function (e, ui) {\n    //     window.$(this).attr('data-previndex', ui.item.index());\n    //   },\n    //   update: function (e, ui) {\n    //     // var newIndex = ui.item.index();\n    //     // var oldIndex = window.$(this).attr('data-previndex');\n    //     // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n    //     window.$(this).removeAttr('data-previndex');\n    //     changeSessionOrder();\n    //   }\n\n    window.winpop_listener = function (data) {\n      if (data === true) {\n        window.location.reload(true);\n      }\n    };\n  });\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest (session) {\n    return window.axios({\n      method: 'put',\n      url: '/course/courselist',\n      data: {\n        title: session.children('a').data('title'),\n        course_list_id: session.children('a').data('id'),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder () {\n    var promises = [];\n    var items = window.$('.session-content > .list-group-item');\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises)\n    .then(window.axios.spread(function (acct, perms) {\n      if (acct.data.success) {\n        window.alert('세션순서를 변경하였습니다.');\n      }\n    }));\n  }\n\n  // 체크리스트 보기\n  btnPreviewChecklist.bind('click', function (e) {\n    e.preventDefault();\n    var courseListId = window.$(this).parent('span').data('course-list-id');\n    if (!courseListId) {\n      courseListId = window.$(this).data('id');\n    }\n    Util.createWindowPopup('/course/checklist?course_list_id=' + courseListId, 'Checklist', windowOption);\n  });\n\n  // 비디오 보기\n  btnWatch.bind('click', function (e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr('data-video-id');\n    Util.createWindowPopup('/course/video?id=' + videoId, 'Video', windowOption);\n  });\n\n  // 강의 삭제하기\n  btnDeleteCourse.bind('click', function () {\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var params = {\n      id: window.$(this).data('course-id')\n    };\n\n    window.axios.delete('/course/deactivate',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('강의를 삭제하였습니다.');\n        } else {\n          window.alert('강의를 삭제하였습니다.');\n          window.location.href = '/course';\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 비디오 생성하기\n  btnCreateVideo.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/video?course_id=' + courseId, 'Video', windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  btnSolveQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr('data-quiz-group');\n    var dataTitle = window.$(this).attr('data-title');\n    var dataType = window.$(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n\n  // 퀴즈 생성하기\n  btnCreateQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=QUIZ', 'Quiz', windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateFinalQuiz.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=FINAL', 'Final', windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateChecklist.bind('click', function (e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/checklist?course_id=' + courseId + '&type=CHECK', 'Checklist', windowOption);\n  });\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession (params) {\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          window.location.reload();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 세션을 삭제한다.\n   *\n   */\n  btnDeleteSession.bind('click', function (e) {\n    e.preventDefault();\n\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var params = {};\n    params.course_list_id = window.$(this).parent('span').data('course-list-id');\n    params.course_list_type = window.$(this).parent('span').data('type');\n\n    var courselistType = window.$(this).parent('span').data('type');\n    switch (courselistType) {\n    case 'QUIZ':\n    case 'FINAL':\n      params.quiz_group_id = window.$(this).data('quiz-group');\n      break;\n    case 'VIDEO':\n      params.video_id = window.$(this).data('video-id');\n      break;\n    case 'CHECKLIST':\n      params.checklist_group_id = window.$(this).data('checklist-group');\n      break;\n    default:\n      break;\n    }\n    deleteSession(params);\n  });\n\n  /**\n   * 세션 수정하기\n   */\n  btnModifySession.bind('click', function (e) {\n    e.preventDefault();\n\n    var dataCourseId = window.$(this).parent('span').data('course-id');\n    var dataCourseListId = window.$(this).parent('span').data('course-list-id');\n    var dataVideoId = window.$(this).data('video-id');\n    var dataQuizGroupId = window.$(this).data('quiz-group');\n    var dataChecklistGroupId = window.$(this).data('checklist-group');\n    var dataType = window.$(this).parent('span').data('type'); // VIDEO/QUIZ/FINAL\n\n    if (dataType === 'VIDEO') {\n      Util.createWindowPopup('/course/modify/video?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&video_id=' + dataVideoId, 'Video', windowOption);\n    } else if (dataType === 'QUIZ' || dataType === 'FINAL') {\n      Util.createWindowPopup('/course/modify/quiz?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&quiz_group_id=' + dataQuizGroupId, 'Quiz', windowOption);\n    } else if (dataType === 'CHECKLIST') {\n      Util.createWindowPopup('/course/modify/checklist?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&checklist_group_id=' + dataChecklistGroupId, 'Checklist', windowOption);\n    }\n  });\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  // function makeSessionOrderChangeRequest (session) {\n  //   return window.axios({\n  //     method: 'put',\n  //     url: '/course/courselist',\n  //     data: {\n  //       title: session.children().children('a').data('title'),\n  //       course_list_id: session.children().children('a').data('id'),\n  //       course_list_order: session.index()\n  //     }\n  //   });\n  // }\n\n  // /**\n  //  * 세션순서를 변경한다.\n  //  */\n  // function changeSessionOrder () {\n  //   var promises = [];\n  //   var items = window.$('.session-list');\n\n  //   for (var index = 0; index < items.length; index++) {\n  //     promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n  //   }\n\n  //   window.axios.all(promises).then(function (results) {\n  //     results.forEach(function (response) {\n  //     });\n  //   });\n  // }\n});\n"],"sourceRoot":"/source/"}