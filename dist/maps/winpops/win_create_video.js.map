{"version":3,"sources":["winpops/win_create_video.js"],"names":["requirejs","btnRegistVideo","validateForm","video_title","$","video_code","val","alert","displayVideo","video_provider","video_player","html","btnPlayVideo","window","_confirm","bind","e","which","keyCode","preventDefault","confirm","params","serialize","ajax","url","attr","type","data","contentType","response","dataType","opener","winpop_listener","parent","close","onbeforeunload","event"],"mappings":"AAAA,YAEAA,YAKE,SACA,SAEA,SAAIC,EAAAA,GA6EJ,QAASC,KACP,GAAIC,GAAcC,EAAE,gBADtBC,EAASH,EAAT,cAEE,OAAIG,GAAaD,QAKfC,EAAAC,QACDC,MAAA,kBACDF,EAAKA,SACG,IALNE,MAAM,mBADRJ,EAAKA,SACG,GAgBV,QAASK,KACP,GAAIH,GAAaD,EAAE,eAAeE,MADpCG,EAAAL,EAAyB,mBAAAE,MACnBD,EAAeD,EAAA,gBAEnB,KAAIM,EAAeN,OAAE,CAErB,QAAKC,GAAc,IAAA,UAAeK,EAAAC,KAAA,wEAAAN,EAAA,6CAElC,MACA,KAAA,QACEK,EAAAA,KAAaC,+CAAKN,EAAA,gJA1GtB,GAAIO,GAAAA,GAAAA,OAAeR,EAGnBS,EAAqBT,EAAA,iBACnBQ,EAAAR,EAAA,eACAU,GAAA,CAEDD,QAJDT,EAAA,cAoCqCA,EAAA,eAAAW,KAAA,WAAA,SAAAC,GAFrC,MAGUA,EAAAC,OAAAD,EAAAE,UAHVV,MAQMI,EAAAG,KAAA,QAAA,SAAAC,GAFNR,MAKAP,EAAec,KAAK,QAAS,SAAUC,GAGC,GAAtCA,EAAAG,kBAAsCjB,IAAA,OAAA,CAEtC,KAAKW,OAAOO,QAAQ,aAAc,OAAA,CAAiB,IAAAC,GAAAjB,EAAA,QAAAkB,WAGnDlB,GAAEmB,MADFC,IAAIH,EAAAA,QAAWI,KAAF,UACXF,KAAK,OACLC,KAAKpB,EACLsB,YAFK,mDAGLC,SAAMN,OACNO,QAAAA,SAAaC,GACbC,OAAAA,MAAU,iBAERjB,OAAON,OAAMwB,OAAAC,kBAEbnB,GAAOoB,EAGPpB,OAAOqB,aAuDbrB,OAAOsB,eAAiB,SAAUC,GAChC,GAAItB,EAAY,MAAOM,SAAQ","file":"winpops/win_create_video.js","sourcesContent":["'use strict';\n\nrequirejs([\n  'common',\n  'Vimeo'\n],\nfunction (Util, Vimeo) {\n  var $ = $ || window.$;\n  var player = null;\n  // var playerContainer = $('#videoplayer');\n  var btnRegistVideo = $('#regist-video');\n  var btnPlayVideo = $('#play-video');\n  var _confirm = true; // 윈도우 종료 시 창을 닫을지 여부\n\n  window.$(function () {\n    // console.log('hello!');\n    // window.alert(window.parent.opener);\n    // window.parent.opener.winpop_listener();\n  });\n\n  /**\n   * Player 를 초기화 한다.\n   */\n  function initPlayer () {\n    var videoUrl = $('#video-code').val();\n    var options = {\n      url: videoUrl,\n      loop: false\n    };\n\n    if (player) {\n      player.unload().then(function () {\n        console.info(player);\n        player.loadVideo('157991194');\n      }).catch(function (error) {\n        console.log('비메오 오류발생!');\n        console.error(error);\n      });\n    } else {\n      player = new Vimeo('videoplayer', options);\n      player.setVolume(0.5);\n      player.on('error', function (data) {\n        console.log('비메오 오류발생!');\n        console.error(data);\n      });\n    }\n  }\n\n  $('#video-code').bind('keypress', function (e) {\n    var key = e.which || e.keyCode;\n    if (key === 13) { displayVideo(); }\n            // initPlayer();\n  });\n\n  btnPlayVideo.bind('click', function (e) {\n    displayVideo();\n        // initPlayer();\n  });\n\n  btnRegistVideo.bind('click', function (e) {\n    e.preventDefault();\n\n    if (!validateForm()) { return false; }\n\n    if (!window.confirm('저장하시겠습니까?')) { return false; }\n\n    var params = $('form').serialize();\n    $.ajax({\n      url: $('form').attr('action'),\n      type: 'POST',\n      data: params,\n      contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\n      dataType: 'html',\n      success: function (response) {\n        window.alert('비디오를 저장하였습니다.');\n        // window.parent.opener.location.reload(); // 부모폼을 reload 한다.\n        window.parent.opener.winpop_listener();\n\n        _confirm = false;\n        window.close();\n      }\n    });\n  });\n\n    /**\n     * 폼 validate\n     */\n  function validateForm () {\n    var video_title = $('#video-title');\n    var video_code = $('#video-code');\n\n    if (!video_title.val()) {\n      alert('비디오 강좌명을 입력하세요.');\n      video_title.focus();\n      return false;\n    }\n    if (!video_code.val()) {\n      alert('비디오 코드를 입력하세요.');\n      video_code.focus();\n      return false;\n    }\n\n    return true;\n  }\n\n    /**\n     * 비디오를 표시한다.\n     */\n  function displayVideo () {\n    var video_code = $('#video-code').val();\n    var video_provider = $('#video-provider').val();\n    var video_player = $('#video-player');\n\n    if (!video_code) { return false; }\n\n    switch (video_provider) {\n    case 'YOUTUBE':\n      video_player.html('<iframe width=\"100%\" height=\"600\" src=\"https://www.youtube.com/embed/' + video_code + '\"' +\n                    'frameborder=\"0\" allowfullscreen></iframe>');\n      break;\n    case 'VIMEO':\n      video_player.html('<iframe src=\"https://player.vimeo.com/video/' + video_code + '\"?title=0&byline=0&portrait=0\" ' +\n                    'width=\"100%\" height=\"600\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>');\n      break;\n\n    default:\n      break;\n    }\n  }\n\n    /**\n     * 윈도우 팝업창 종료 시 발생\n     *\n     */\n  window.onbeforeunload = function (event) {\n    if (_confirm) { return confirm('진행중인 작업이 모두 사라집니다. 계속하시겠습니까?'); }\n  };\n});\n"],"sourceRoot":"/source/"}