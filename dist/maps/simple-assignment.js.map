{"version":3,"sources":["simple-assignment.js"],"names":["window","requirejs","activatedStep","sessionTemplate","$","setEmployeeIds","employeeIds","tableEmployee","rows","children","nodes","prop","checked","pointTotal","val","sumPoint","each","this","parent","find","parseInt","getSessionList","data","refresh","sortable","connectWith","selectedCourseId","undefined","attr","sessionLoaded","axios","get","update","res","$selectedPanel","html","getSessionView","session_list","changeSessionOrder","start","disableSelection","e","ui","item","index","console","err","removeAttr","catch","log","eduId","tableCheckAll","edu_course_list","append","getCourseView","navListItems","last","$item","hasClass","activateStep","step","saveStep1Data","nextSelector","currSelector","removeClass","preventDefault","trigger","updateProgress","post","id","assignmentId","formData","response","error","FormData","document","getElementById","files","then","logBindUserId","alert","saveStep2Data","name","desc","tinymce","activeEditor","getContent","complete_point","quiz_point","reeltime_point","speed_point","trainingEduId","assigment_id","upload_employee_ids","log_bind_user_id","training_edu_id","can_replay","params","success","location","deleteAssignment","confirm","delete","currentTabId","join","href","validateStep1","filter","map","$eduDescription","length","$eduName","focus","pointIsValid","input","sum","session","results","forEach","url","title","course_list_id","course_list_order","$panelGroup","items","promises","addCourse","makeSessionOrderChangeRequest","course_name","$modal","course_desc","teacher_name","target","prev","parents","closest","course_id","course_rate","onModifyCourseModalOpen","submit","teacher_rate","execCommand","replaceWith","modal","relatedTarget","end","setContent","allWells","_","Util","btnDeleteSimpleAssign","btnSaveSimpleAssign","lengthMenu","btnSendMessage","columnDefs","courseView","Handlebars","windowOption","compile","courseTemplate","sessionView","initDateTimePicker","i","$tinymceDesc","getCourseList","$target","show","activatedPanel","click","toString","on","validateStep2","addClass","text","debounce","point","updateCourse","createWindowPopup","quizGroupId","toggleIcon","courseId","dataTitle","dataType","courselistType","quiz_group_id","video_id","course_list_type","dataCourseId","dataVideoId","dataQuizGroupId","checklist_group_id","courseListId","remove","dataChecklistGroupId","dataCourseListId","videoId","checkedEmployeeIds","message","method","phones","msg","row","messageInput","trim"],"mappings":"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","file":"simple-assignment.js","sourcesContent":["'use strict';\n\nwindow.requirejs([\n  'common',\n  'text!../course.template.html',\n  'text!../session.template.html'\n], function (Util, courseTemplate, sessionTemplate) {\n  var $ = undefined || window.$;\n  var _ = undefined || window._;\n  var assignmentId = $('#assignment_id').val();\n  var activatedStep = $('#activated_step').val();\n  var navListItems = $('ul.setup-panel li a');\n  var allWells = $('.setup-content');\n  var tableCheckAll = $('#check-all');\n  var tableEmployee = Util.initDataTable($('#table_employee'), {\n    'lengthMenu': [ [5, 10, 25, 50, -1], [5, 10, 25, 50, '전체'] ],\n    'columnDefs': [\n      { orderable: false, targets: [0] }\n    ]});\n  var btnDeleteSimpleAssign = $('#js-delete-simple-assign');\n  var btnSaveSimpleAssign = $('#js-save-simple-assign');\n  var btnSendMessage = $('.btn-send-message');\n  var messageInput = $('.message');\n  var courseView = window.Handlebars.compile(courseTemplate);\n  var sessionView = window.Handlebars.compile(sessionTemplate);\n  var windowOption = 'scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, resizable=yes, width=1040, height=760, left=0, top=0';\n\n  $(function () {\n    allWells.hide();\n\n    // DateTimePicker 설정\n    Util.initDateTimePicker(\n      $('.date#start_dt'),\n      $('.date#end_dt')\n    );\n\n    $('ul.setup-panel li').map(function () {\n      let $item = $(this);\n\n      for (var i = 2; i <= activatedStep; i++) {\n        if (i === $item.index() + 1) {\n          activateStep(i);\n        }\n      }\n    });\n\n    if ($('#edu_id').val()) {\n      getCourseList();\n    }\n\n    // 교육대상자 id 조회\n    setEmployeeIds();\n\n    var $tinymceDesc = $('#input-course-desc_ifr');\n    if ($tinymceDesc) {\n      $tinymceDesc.prop('title', '');\n    }\n\n    sumPoint();\n  });\n\n  // 교육대상자 id 조회\n  function setEmployeeIds () {\n    var employeeIds = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n      return $(this).data('id');\n    }).get().join(', ');\n    $('input[name=\\'upload_employee_ids\\']').val(employeeIds);\n  }\n\n  function sumPoint () {\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '') {\n        pointTotal += parseInt($(this).val());\n      }\n    });\n\n    $('.badge').text(pointTotal);\n    return pointTotal;\n  }\n\n  /**\n   * 윈도우 팝업창에서의 저장 작업 완료 시 호출된다.\n   * @data: 갱신여부를 반환한다. true 일 경우 세션정보를 갱신한다.\n   */\n  window.winpop_listener = function (data) {\n    getSessionList(data);\n  };\n\n  /**\n   * 세션목록 조회\n   * 처음 강의를 열었을 때와 세션정보가 변경되는 경우만 세션 정보를 갱신한다.\n   */\n  function getSessionList (refresh) {\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var $selectedPanel = $('.panel[data-id=' + selectedCourseId + ']');\n\n    if ($selectedPanel.data('metadata').sessionLoaded === undefined || refresh) {\n      window.axios.get('/course/' + selectedCourseId)\n      .then(function (res) {\n        if (res.data) {\n          $selectedPanel.find('.session-content').html(getSessionView({ session_list: res.data.session_list }));\n          $selectedPanel.data('metadata').sessionLoaded = true;\n\n          $('.list-group').sortable({\n            connectWith: '.list-group-item',\n            start: function (e, ui) {\n              $(this).attr('data-previndex', ui.item.index());\n            },\n            update: function (e, ui) {\n              // var newIndex = ui.item.index();\n              // var oldIndex = window.$(this).attr('data-previndex');\n              // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n              $(this).removeAttr('data-previndex');\n              changeSessionOrder();\n            }\n          }).disableSelection();\n        }\n      })\n      .catch(function (err) {\n        console.log(err);\n      });\n    }\n  }\n\n  /**\n   * 강의목록 조회\n   */\n  function getCourseList () {\n    var eduId = $('#edu_id').val();\n\n    window.axios.get('/education/' + eduId + '/courses')\n    .then(function (res) {\n      if (res.data) {\n        $.each(res.data.edu_course_list, function (index, data) {\n          $('#course-list').append(getCourseView(data));\n          $('.panel').last().data('metadata', data);\n        });\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  tableCheckAll.bind('click', function () {\n    $(':checkbox', tableEmployee.rows().nodes()).prop('checked', this.checked);\n  });\n\n  navListItems.click(function (e) {\n    e.preventDefault();\n    var $target = $($(this).attr('href'));\n    var $item = $(this).closest('li');\n\n    if (!$item.hasClass('disabled')) {\n      navListItems.closest('li').removeClass('active');\n      $item.addClass('active');\n      allWells.hide();\n      $target.show();\n    }\n  });\n\n  if (activatedStep > 1) {\n    var activatedPanel = 'ul.setup-panel li a:eq(' + (activatedStep - 1).toString() + ')';\n    $(activatedPanel).click();\n  } else {\n    $('ul.setup-panel li.active a').trigger('click');\n  }\n\n  function activateStep (step) {\n    var currSelector = 'ul.setup-panel li:eq(' + (parseInt(step) - 1) + ')';\n    var nextSelector = 'ul.setup-panel li a[href=\"#step-' + step + '\"]';\n\n    $(currSelector).removeClass('disabled');\n    $(nextSelector).trigger('click');\n\n    // updateProgress(step);\n  }\n\n  $('.step1 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep1()) {\n      activateStep(2);\n      saveStep1Data();\n    }\n  });\n  $('.step2 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(1);\n  });\n  $('.step2 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep2()) {\n      activateStep(3);\n      saveStep2Data();\n    }\n  });\n  $('.step3 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(2);\n  });\n  $('.step3 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(4);\n    // updateProgress(3);\n  });\n  $('.step4 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(3);\n  });\n\n  $('.panel-collapse').on('hide.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n  });\n\n  $('.panel-collapse').on('show.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n  });\n\n  btnDeleteSimpleAssign.on('click', deleteAssignment);\n  btnSaveSimpleAssign.on('click', function () {\n    // updateProgress($('ul.setup-panel li.active').index() + 1);\n    var step = $('ul.setup-panel li.active').index() + 1;\n    switch (step) {\n    case 1:\n      if (validateStep1()) {\n        saveStep1Data();\n      }\n      break;\n    case 2:\n      if (validateStep2()) {\n        saveStep2Data();\n      }\n      break;\n    default:\n      break;\n    }\n  });\n\n  function updateProgress (step) {\n    window.axios.post('/simple_assignment/progress', {\n      step: step,\n      id: assignmentId\n    })\n    .then(function (response) {\n      activatedStep(step);\n      return true;\n    })\n    .catch(function (error) {\n      console.log(error);\n      return false;\n    });\n  }\n\n  /**\n   * 교육 대상자를 저장한다.\n   */\n  function saveStep1Data () {\n    var formData = new window.FormData();\n    formData.append('upload_type', $('input[name=\\'upload_type\\']').val());\n    formData.append('upload_employee_ids', $('input[name=\\'upload_employee_ids\\']').val());\n    formData.append('file-excel', document.getElementById('UploadExcelFile').files[0]);\n    formData.append('group_name', '간편배정');\n    formData.append('redirect', false);\n    formData.append('id', assignmentId);\n\n    window.axios.post('/assignment/upload', formData)\n      .then(function (res) {\n        if (res.data) {\n          // $('input[name=\\'upload_employee_ids\\']').val(res.data.employeeIds);\n          $('#log_bind_user_id').val(res.data.logBindUserId);\n          window.alert('교육생을 저장하였습니다.');\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 교육과정 정보, 포인트 및 교육기간 정보를 저장한다.\n   */\n  function saveStep2Data () {\n    var data = {\n      'name': $('input[name=\\'course_name\\']').val(),\n      'desc': window.tinymce.activeEditor.getContent(),\n      'complete_point': $('input[name=\\'complete_point\\']').val(),\n      'quiz_point': $('input[name=\\'quiz_point\\']').val(),\n      'test_point': $('input[name=\\'test_point\\']').val(),\n      'reeltime_point': $('input[name=\\'reeltime_point\\']').val(),\n      'speed_point': $('input[name=\\'speed_point\\']').val(),\n      'reps_point': $('input[name=\\'reps_point\\']').val(),\n      'start_dt': $('input[name=\\'start_dt\\']').val(),\n      'finish_dt': $('input[name=\\'finish_dt\\']').val(),\n      'assigment_id': assignmentId,\n      'upload_employee_ids': $('input[name=\\'upload_employee_ids\\']').val(),\n      'edu_id': $('#edu_id').val(),\n      'log_bind_user_id': $('#log_bind_user_id').val(),\n      'training_edu_id': $('#training_edu_id').val(),\n      'can_replay': $('#can-replay').prop('checked') ? 1 : 0\n    };\n\n    // console.log(data);\n    // return false;\n\n    window.axios.post('/education', data)\n    .then(function (res) {\n      // console.log(res);\n      if (res.data) {\n        $('#training_edu_id').val(res.data.trainingEduId);\n        $('#edu_id').val(res.data.eduId);\n        window.alert('교육과정을 저장하였습니다.');\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  function deleteAssignment () {\n    if (!window.confirm('정말 삭제하시겠습니까?')) return false;\n\n    var params = {\n      id: assignmentId\n    };\n\n    window.axios.delete('/simple_assignment',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('배정내역을 삭제하지 못하였습니다.');\n        } else {\n          window.alert('교육과정을 삭제하였습니다.');\n          window.location.href = '/simple_assignment';\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 1. 교육 대상자 선택\n   */\n  function validateStep1 () {\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var data = null;\n\n    $('input[name=\\'upload_type\\']').val(currentTabId);\n\n    switch (currentTabId) {\n    case 'employee': // 등록된 직원\n      data = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n        return $(this).data('id');\n      }).get().join(', ');\n\n      if (!data) {\n        window.alert('직원을 선택하세요.');\n        return false;\n      }\n\n      $('input[name=\\'upload_employee_ids\\']').val(data);\n      break;\n\n    case 'excel': // 파일업로드\n      if (document.getElementById('UploadExcelFile').files.length === 0) {\n        $('#UploadExcelFile').focus();\n        window.alert('파일을 선택하세요.');\n        return false;\n      }\n      break;\n\n    default:\n      break;\n    }\n\n    return true;\n  }\n\n  /**\n   * 2. 교육과정 입력\n   */\n  function validateStep2 () {\n    var $eduName = $('input[name=\\'course_name\\']');\n    var $eduDescription = $('#input-course-desc').val(); // window.tinymce.activeEditor.getContent();\n\n    if ($eduName.val() === '') {\n      window.alert('교육과정명을 입력하세요.');\n      $eduName.focus();\n      return false;\n    }\n\n    if ($eduDescription === '') {\n      window.alert('교육과정에 대한 설명을 입력하세요.');\n      window.tinymce.execCommand('mceFocus', false, 'input-course-desc');\n      return false;\n    }\n\n    var pointIsValid = true;\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() === '') {\n        window.alert($(this).prop('placeholder') + ' 포인트 점수를 입력하세요.');\n        $(this).focus();\n        pointIsValid = false;\n        return false;\n      } else {\n        pointTotal += parseInt($(this).val());\n      }\n    });\n\n    // console.log(pointTotal);\n    if (!pointIsValid) return false;\n    if (pointTotal !== 100) {\n      window.alert('포인트의 합계는 100점이 되어야 합니다.');\n      return false;\n    }\n\n    return true;\n  }\n\n  $('.input-group-addon').children('input:checkbox').on('change', function () {\n    var input = $(this).parent().parent().find('.point-item');\n\n    input.prop('disabled', !$(this).prop('checked'));\n\n    if ($(this).prop('checked')) {\n      input.focus();\n    };\n  });\n\n  $('.point-item').on('keyup', _.debounce(function () {\n    var sum = 0;\n\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '' && $(this).val() !== '0') {\n        var point = parseInt($(this).val());\n        sum += point;\n      } else {\n        // $(this).prop('disabled', true);\n        // $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked', false);\n      }\n    });\n\n    if (sum > 0) {\n      $('.badge').text(sum);\n    }\n\n    if (sum > 100) {\n      window.alert('100점을 초과하였습니다.');\n      return false;\n    }\n  }, 300));\n\n  function getCourseView (data) {\n    return courseView(data);\n  }\n\n  function getSessionView (data) {\n    return sessionView(data);\n  }\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession (params) {\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          window.location.reload();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest (session) {\n    return window.axios({\n      method: 'put',\n      url: '/course/courselist',\n      data: {\n        title: session.children('a').data('title'),\n        course_list_id: session.children('a').data('id'),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder () {\n    var promises = [];\n    var items = window.$('.session-content > .list-group-item');\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises).then(function (results) {\n      results.forEach(function (response) {\n        console.log(response);\n      });\n    });\n  }\n\n  function toggleIcon (e) {\n    $(e.target)\n      .prev('.panel-heading')\n      .find('.more-less')\n      .toggleClass('glyphicon-plus glyphicon-minus');\n\n    // panel-group 에 현재 편집중인 강의 id 를 입력한다.\n    var $panelGroup = $(e.target).parents().find('.panel-group');\n    var selectedCourseId = $(e.target).parents().closest('.panel').data('id');\n\n    if ($panelGroup.data('selected-course-id') !== selectedCourseId) {\n      $panelGroup.data('selected-course-id', selectedCourseId);\n      getSessionList();\n    }\n  }\n\n  function addCourse () {\n    var $modal = $('#registerCourse');\n    var data = {\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      edu_id: $('#edu_id').val()\n    };\n\n    window.axios.post('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        if ($('#course-list').children().length === 0) {\n          var currSelector = 'ul.setup-panel li:eq(3)'; // 4. 메세지\n          $(currSelector).removeClass('disabled');\n          updateProgress(4);\n        }\n        $('#course-list').append(getCourseView(res.data));\n        $('.panel').last().data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function updateCourse () {\n    var $modal = $('#modifyCourse');\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var data = {\n      course_id: selectedCourseId,\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      course_rate: 0,\n      teacher_rate: 0\n    };\n\n    window.axios.put('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        // console.log(res.data);\n        $('.panel[data-id=' + res.data.course_id + ']').replaceWith(getCourseView(res.data));\n        $('.panel[data-id=' + res.data.course_id + ']').data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function onModifyCourseModalOpen (e) {\n    var data = $(e.relatedTarget).parents().find('.panel').data('metadata');\n    var $modal = $(this);\n\n    $modal.find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n    $modal.find('input[name=\\'course_name\\']').val(data.course_name);\n    $modal.find('input[name=\\'teacher_name\\']').val(data.teacher_name);\n    window.tinymce.get('course_desc').setContent(data.course_desc);\n    $modal.find('[autofocus]').focus();\n  }\n\n  $('#registerCourse').submit(function (e) {\n    e.preventDefault();\n\n    addCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n  $('#modifyCourse').submit(function (e) {\n    e.preventDefault();\n\n    updateCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n\n  $('.panel-group').on('hidden.bs.collapse', toggleIcon);\n  $('.panel-group').on('shown.bs.collapse', toggleIcon);\n  $('#registerCourse').on('hidden.bs.modal', function () {\n    $(this).find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n  });\n  $('#registerCourse').on('shown.bs.modal', function () {\n    $(this).find('[autofocus]').focus();\n  });\n  $('#modifyCourse').on('shown.bs.modal', onModifyCourseModalOpen);\n  // $('#modifyCourse').on('hidden.bs.modal', onModifyCourseModalClose);\n\n  // 비디오 생성하기\n  $('.panel-group').on('click', '.btn-create-video', function (e) {\n    e.preventDefault();\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/video?course_id=' + courseId, 'Video', windowOption);\n  });\n  // 퀴즈 풀어보기\n  $('.panel-group').on('click', '.btn-create-video', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = $(this).attr('data-quiz-group');\n    var dataTitle = $(this).attr('data-title');\n    var dataType = $(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n  // 퀴즈 생성하기\n  $('.panel-group').on('click', '.btn-create-quiz', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=QUIZ', 'Quiz', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-final', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=FINAL', 'Final', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-checklist', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/checklist?course_id=' + courseId + '&type=CHECK', 'Checklist', windowOption);\n  });\n  // 세션을 삭제한다.\n  $('.panel-group').on('click', '.btn-delete-session', function (e) {\n    e.preventDefault();\n\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var $self = $(this);\n    var params = {};\n    params.course_list_id = $(this).parent('span').data('course-list-id');\n    params.course_list_type = $(this).parent('span').data('type');\n\n    var courselistType = $(this).parent('span').data('type');\n    switch (courselistType) {\n    case 'QUIZ':\n    case 'FINAL':\n      params.quiz_group_id = $(this).data('quiz-group');\n      break;\n    case 'VIDEO':\n      params.video_id = $(this).data('video-id');\n      break;\n    case 'CHECKLIST':\n      params.checklist_group_id = $(this).data('checklist-group');\n      break;\n    default:\n      break;\n    }\n\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          $self.parents('li').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 세션 수정하기\n  $('.panel-group').on('click', '.btn-modify-session', function (e) {\n    e.preventDefault();\n\n    var dataCourseId = $(this).parent('span').data('course-id');\n    var dataCourseListId = $(this).parent('span').data('course-list-id');\n    var dataVideoId = $(this).data('video-id');\n    var dataQuizGroupId = $(this).data('quiz-group');\n    var dataChecklistGroupId = $(this).data('checklist-group');\n    var dataType = $(this).parent('span').data('type'); // VIDEO/QUIZ/FINAL\n\n    if (dataType === 'VIDEO') {\n      Util.createWindowPopup('/course/modify/video?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&video_id=' + dataVideoId, 'Video', windowOption);\n    } else if (dataType === 'QUIZ' || dataType === 'FINAL') {\n      Util.createWindowPopup('/course/modify/quiz?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&quiz_group_id=' + dataQuizGroupId, 'Quiz', windowOption);\n    } else if (dataType === 'CHECKLIST') {\n      Util.createWindowPopup('/course/modify/checklist?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&checklist_group_id=' + dataChecklistGroupId, 'Checklist', windowOption);\n    }\n  });\n\n  // 체크리스트 보기\n  $('.panel-group').on('click', '.btn-preview-checklist', function (e) {\n    e.preventDefault();\n    var courseListId = window.$(this).parent('span').data('course-list-id');\n    if (!courseListId) {\n      courseListId = window.$(this).data('id');\n    }\n    Util.createWindowPopup('/course/checklist?course_list_id=' + courseListId, 'Checklist', windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  $('.panel-group').on('click', '.btn-solve-quiz', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr('data-quiz-group');\n    var dataTitle = window.$(this).attr('data-title');\n    var dataType = window.$(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n\n  // 비디오 보기\n  $('.panel-group').on('click', '.btn-watch-video', function (e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr('data-video-id');\n    Util.createWindowPopup('/course/video?id=' + videoId, 'Video', windowOption);\n  });\n\n  $('.panel-group').on('click', '.btn-delete-course', function () {\n    if (window.confirm('선택하신 강의를 삭제하시겠습니까?')) {\n      var selectedCourseId = $('.panel-group').data('selected-course-id');\n\n      window.axios.delete('/course/deactivate', { params: { id: selectedCourseId } })\n      .then(function (res) {\n        if (res.data.success) {\n          $('.panel[data-id=' + selectedCourseId + ']').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n  });\n\n  btnSendMessage.on('click', function (e) {\n    e.preventDefault();\n\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var checkedEmployeeIds;\n    switch (currentTabId) {\n    case 'employee':\n      checkedEmployeeIds = window.$(':checkbox:checked',\n        tableEmployee.rows({filter: 'applied'}).nodes()).map(\n          function () {\n            return tableEmployee.row(window.$(this).parents('tr')).data()[4];\n          }\n        ).get().join(',');\n      break;\n    case 'employee-assigned':\n      // checkedEmployeeIds = window.$(':checkbox:checked',\n      //   tableAssignedEmployee.rows({filter: 'applied'}).nodes()).map(\n      //     function () {\n      //       return tableAssignedEmployee.row(window.$(this).parents('tr')).data()['user_phone'];\n      //     }\n      //   ).get().join(',');\n      break;\n    default:\n      break;\n    }\n\n    if (!checkedEmployeeIds) {\n      window.alert('직원을 선택하세요.');\n      return false;\n    }\n\n    var message = messageInput.val().trim();\n    if (message === '') {\n      window.alert('메세지를 입력하세요.');\n      messageInput.focus();\n      return false;\n    }\n\n    if (!window.confirm('메세지를 보내시겠습니까?')) {\n      return false;\n    }\n\n    window.axios({\n      method: 'post',\n      url: '/api/v1/sms/send',\n      data: {\n        phones: checkedEmployeeIds,\n        msg: message\n      }\n    })\n    .then(\n      function (res) {\n        if (res.data.success === true) {\n          window.alert('메세지를 전송하였습니다.');\n        } else {\n          window.alert('알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.');\n        }\n      });\n  });\n});\n"],"sourceRoot":"/source/"}