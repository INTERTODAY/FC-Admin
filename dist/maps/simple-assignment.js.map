{"version":3,"sources":["simple-assignment.js"],"names":["window","requirejs","activatedStep","sessionTemplate","sumPoint","pointTotal","$","tableEmployee","rows","filter","nodes","map","this","each","get","checked","val","employeeIds","parent","find","children","prop","parseInt","text","winpop_listener","$selectedPanel","data","sessionLoaded","selectedCourseId","undefined","connectWith","refresh","start","attr","res","update","html","getSessionView","session_list","sortable","removeAttr","changeSessionOrder","ui","item","index","e","disableSelection","catch","getCourseList","eduId","err","axios","then","getEduInfo","append","getCourseView","last","console","log","tableCheckCourseAll","tableCourses","btnApplyEdu","validateStep1","step","currSelector","nextSelector","confirm","trigger","updateProgress","post","id","assignmentId","response","formData","error","saveStep1Data","btnSaveSimpleAssign","logBindUserId","files","alert","saveStep2Data","message","name","desc","tinymce","activeEditor","getContent","format","complete_point","quiz_point","reeltime_point","speed_point","trainingEduId","assigment_id","upload_employee_ids","log_bind_user_id","training_edu_id","can_replay","edu_id","params","delete","currentTabId","success","join","href","getElementById","$eduDescription","document","length","$eduName","focus","validateStep2","pointIsValid","execCommand","on","input","sum","session","results","forEach","url","title","course_list_id","course_list_order","$panelGroup","getSessionList","items","promises","addCourse","makeSessionOrderChangeRequest","course_name","$modal","course_desc","teacher_name","target","prev","parents","closest","course_id","course_rate","removeClass","onModifyCourseModalOpen","submit","preventDefault","teacher_rate","replaceWith","modal","relatedTarget","end","setContent","navListItems","allWells","_","tableCheckAll","Util","initDataTable","lengthMenu","buttons","btnSendMessage","btnDeleteSimpleAssign","messageInput","courseView","sessionView","Handlebars","compile","courseTemplate","windowOption","hide","initDateTimePicker","$item","i","activateStep","setEmployeeIds","search","bind","hasClass","tableEducations","addClass","$target","activatedPanel","click","toString","deleteAssignment","debounce","point","updateCourse","createWindowPopup","toggleIcon","courseId","courselistType","quiz_group_id","video_id","course_list_type","dataCourseId","dataVideoId","dataQuizGroupId","dataType","checklist_group_id","courseListId","remove","quizGroupId","dataChecklistGroupId","dataCourseListId","videoId","checkedEmployeeIds","method","phones","msg","row","trim"],"mappings":"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","file":"simple-assignment.js","sourcesContent":["'use strict';\n\nwindow.requirejs([\n  'common',\n  'text!../course.template.html',\n  'text!../session.template.html'\n], function (Util, courseTemplate, sessionTemplate) {\n  var $ = undefined || window.$;\n  var _ = undefined || window._;\n  var assignmentId = $('#assignment_id').val();\n  var activatedStep = $('#activated_step').val();\n  var navListItems = $('ul.setup-panel li a');\n  var allWells = $('.setup-content');\n  var tableCheckAll = $('#check-all');\n  var tableCheckCourseAll = $('#js--formAddCourse').find('#check-all');\n  // var tableCourse = Util.initDataTable($('#table_course'));\n  var tableEmployee = Util.initDataTable($('#table_employee'), {\n    'lengthMenu': [ [5, 10, 25, 50, -1], [5, 10, 25, 50, '전체'] ]\n  });\n  var tableCourses = Util.initDataTable($('#js--formAddCourse').find('#table_courses'), {\n    'lengthMenu': [ [5, 10, 25, 50, -1], [5, 10, 25, 50, '전체'] ], buttons: []\n  });\n  var tableEducations = Util.initDataTable($('#js--formAddEdu').find('#table_edu'), {\n    'lengthMenu': [ [5, 10, 25, 50, -1], [5, 10, 25, 50, '전체'] ], buttons: []\n  });\n  var btnDeleteSimpleAssign = $('#js-delete-simple-assign');\n  var btnSaveSimpleAssign = $('#js-save-simple-assign');\n  var btnSendMessage = $('.btn-send-message');\n  var btnApplyEdu = $('#btnApplyEdu');\n\n  var messageInput = $('.message');\n  var courseView = window.Handlebars.compile(courseTemplate);\n  var sessionView = window.Handlebars.compile(sessionTemplate);\n  var windowOption = 'scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, resizable=yes, width=1040, height=760, left=0, top=0';\n\n  $(function () {\n    allWells.hide();\n\n    // DateTimePicker 설정\n    Util.initDateTimePicker(\n      $('.date#start_dt'),\n      $('.date#end_dt')\n    );\n\n    $('ul.setup-panel li').map(function () {\n      let $item = $(this);\n\n      for (var i = 2; i <= activatedStep; i++) {\n        if (i === $item.index() + 1) {\n          activateStep(i);\n        }\n      }\n    });\n\n    if ($('#edu_id').val()) {\n      getCourseList();\n      $('#btnGetEdu').prop('disabled', true);\n    }\n\n    // 교육대상자 id 조회\n    setEmployeeIds();\n\n    sumPoint();\n  });\n\n  // 교육대상자 id 조회\n  function setEmployeeIds () {\n    var employeeIds = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n      return $(this).data('id');\n    }).get().join(', ');\n    $('input[name=\\'upload_employee_ids\\']').val(employeeIds);\n  }\n\n  function sumPoint () {\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '') {\n        pointTotal += parseInt($(this).val());\n      }\n    });\n\n    $('.badge').text(pointTotal);\n    return pointTotal;\n  }\n\n  /**\n   * 윈도우 팝업창에서의 저장 작업 완료 시 호출된다.\n   * @data: 갱신여부를 반환한다. true 일 경우 세션정보를 갱신한다.\n   */\n  window.winpop_listener = function (data) {\n    getSessionList(data);\n  };\n\n  /**\n   * 세션목록 조회\n   * 처음 강의를 열었을 때와 세션정보가 변경되는 경우만 세션 정보를 갱신한다.\n   */\n  function getSessionList (refresh) {\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var $selectedPanel = $('.panel[data-id=' + selectedCourseId + ']');\n\n    if ($selectedPanel.data('metadata').sessionLoaded === undefined || refresh) {\n      window.axios.get('/course/' + selectedCourseId)\n      .then(function (res) {\n        if (res.data) {\n          $selectedPanel.find('.session-content').html(getSessionView({ session_list: res.data.session_list }));\n          $selectedPanel.data('metadata').sessionLoaded = true;\n\n          $('.list-group').sortable({\n            connectWith: '.list-group-item',\n            start: function (e, ui) {\n              $(this).attr('data-previndex', ui.item.index());\n            },\n            update: function (e, ui) {\n              // var newIndex = ui.item.index();\n              // var oldIndex = window.$(this).attr('data-previndex');\n              // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n              $(this).removeAttr('data-previndex');\n              changeSessionOrder();\n            }\n          }).disableSelection();\n        }\n      })\n      .catch(function (err) {\n        console.log(err);\n      });\n    }\n  }\n\n  /**\n   * 강의목록 조회\n   */\n  function getCourseList () {\n    var eduId = $('#edu_id').val();\n\n    window.axios.get('/education/' + eduId + '/courses')\n    .then(function (res) {\n      if (res.data) {\n        $.each(res.data.edu_course_list, function (index, data) {\n          $('#course-list').append(getCourseView(data));\n          $('.panel').last().data('metadata', data);\n        });\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  function getEduInfo (eduId) {\n    window.axios.get('/education/' + eduId + '/pointweight')\n    .then(function (res) {\n      if (res.data) {\n        console.log(res.data);\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  tableCheckAll.bind('click', function () {\n    $(':checkbox', tableEmployee.rows({search: 'applied'}).nodes()).prop('checked', this.checked);\n  });\n\n  tableCheckCourseAll.bind('click', function () {\n    $(':checkbox', tableCourses.rows({search: 'applied'}).nodes()).prop('checked', this.checked);\n  });\n\n  btnApplyEdu.bind('click', function () {\n    var eduId = $('input:first:checked', tableEducations.rows({search: 'applied'}).nodes()).data('id');\n    if (eduId !== undefined) {\n      getEduInfo(eduId);\n    } else {\n      window.alert('교육과정을 선택하세요.');\n    }\n  });\n\n  navListItems.click(function (e) {\n    e.preventDefault();\n    var $target = $($(this).attr('href'));\n    var $item = $(this).closest('li');\n\n    if (!$item.hasClass('disabled')) {\n      navListItems.closest('li').removeClass('active');\n      $item.addClass('active');\n      allWells.hide();\n      $target.show();\n    }\n  });\n\n  if (activatedStep > 1) {\n    var activatedPanel = 'ul.setup-panel li a:eq(' + (activatedStep - 1).toString() + ')';\n    $(activatedPanel).click();\n  } else {\n    $('ul.setup-panel li.active a').trigger('click');\n  }\n\n  function activateStep (step) {\n    var currSelector = 'ul.setup-panel li:eq(' + (parseInt(step) - 1) + ')';\n    var nextSelector = 'ul.setup-panel li a[href=\"#step-' + step + '\"]';\n\n    $(currSelector).removeClass('disabled');\n    $(nextSelector).trigger('click');\n\n    // updateProgress(step);\n  }\n\n  // 1. 교육생 설정\n  $('.step1 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep1()) {\n      if ($('#edu_id').val()) {\n        if (!window.confirm('엑셀 업로드 시 이전 배정내역은 모두 취소되며,\\n배정을 취소하는 경우 학습이력이 모두 초기화 됩니다.\\n그래도 계속 하시겠습니까?')) return false;\n      } else {\n        if (!window.confirm('저장하시겠습니까?')) return false;\n      }\n      activateStep(2);\n      saveStep1Data();\n    }\n  });\n  $('.step2 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(1);\n  });\n  // 2. 교육과정 개설\n  $('.step2 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep2()) {\n      if (!window.confirm('저장하시겠습니까?')) return false;\n      saveStep2Data();\n      activateStep(3);\n    }\n  });\n  $('.step3 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(2);\n  });\n  // 3. 강의 개설\n  $('.step3 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(4);\n    // updateProgress(3);\n  });\n  $('.step4 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(3);\n  });\n\n  $('.panel-collapse').on('hide.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n  });\n\n  $('.panel-collapse').on('show.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n  });\n\n  btnDeleteSimpleAssign.on('click', deleteAssignment);\n  btnSaveSimpleAssign.on('click', function () {\n    // updateProgress($('ul.setup-panel li.active').index() + 1);\n    var step = $('ul.setup-panel li.active').index() + 1;\n\n    $('.step' + step + ' > .next > a').trigger('click');\n    // if (!window.confirm('저장하시겠습니까?')) return false;\n    // switch (step) {\n    // case 1:\n    //   if (validateStep1()) {\n    //     saveStep1Data();\n    //   }\n    //   break;\n    // case 2:\n    //   if (validateStep2()) {\n    //     saveStep2Data();\n    //   }\n    //   break;\n    // default:\n    //   break;\n    // }\n  });\n\n  function updateProgress (step) {\n    window.axios.post('/simple_assignment/progress', {\n      step: step,\n      id: assignmentId\n    })\n    .then(function (response) {\n      activatedStep(step);\n      return true;\n    })\n    .catch(function (error) {\n      console.log(error);\n      return false;\n    });\n  }\n\n  /**\n   * 교육 대상자를 저장한다.\n   */\n  function saveStep1Data () {\n    btnSaveSimpleAssign.prop('disabled', true);\n\n    var formData = new window.FormData();\n    formData.append('upload_type', $('input[name=\\'upload_type\\']').val());\n    formData.append('upload_employee_ids', $('input[name=\\'upload_employee_ids\\']').val());\n    formData.append('file-excel', document.getElementById('UploadExcelFile').files[0]);\n    formData.append('group_name', '간편배정');\n    formData.append('redirect', false);\n    formData.append('id', assignmentId);\n    formData.append('log_bind_user_id', $('#log_bind_user_id').val());\n    formData.append('edu_id', $('#edu_id').val());\n    formData.append('start_dt', $('input[name=\\'start_dt\\']').val());\n    formData.append('finish_dt', $('input[name=\\'finish_dt\\']').val());\n    formData.append('training_edu_id', $('#training_edu_id').val());\n\n    window.axios.post('/assignment/upload', formData)\n      .then(function (res) {\n        if (res.data) {\n          btnSaveSimpleAssign.prop('disabled', false);\n\n          if (res.data.success !== false) {\n            $('#log_bind_user_id').val(res.data.logBindUserId);\n            window.alert('교육생을 저장하였습니다.');\n          } else {\n            window.alert('교육생을 저장하지 못하였습니다.');\n            console.log(res.data.message);\n          }\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 교육과정 정보, 포인트 및 교육기간 정보를 저장한다.\n   */\n  function saveStep2Data () {\n    var data = {\n      'name': $('input[name=\\'course_name\\']').val(),\n      'desc': window.tinymce.activeEditor.getContent({format: 'raw'}),\n      'complete_point': $('input[name=\\'complete_point\\']').val(),\n      'quiz_point': $('input[name=\\'quiz_point\\']').val(),\n      'test_point': $('input[name=\\'test_point\\']').val(),\n      'reeltime_point': $('input[name=\\'reeltime_point\\']').val(),\n      'speed_point': $('input[name=\\'speed_point\\']').val(),\n      'reps_point': $('input[name=\\'reps_point\\']').val(),\n      'start_dt': $('input[name=\\'start_dt\\']').val(),\n      'finish_dt': $('input[name=\\'finish_dt\\']').val(),\n      'assigment_id': assignmentId,\n      'upload_employee_ids': $('input[name=\\'upload_employee_ids\\']').val(),\n      'edu_id': $('#edu_id').val(),\n      'log_bind_user_id': $('#log_bind_user_id').val(),\n      'training_edu_id': $('#training_edu_id').val(),\n      'can_replay': $('#can-replay').prop('checked') ? 1 : 0\n    };\n\n    // console.log(data);\n    // return false;\n\n    window.axios.post('/education', data)\n    .then(function (res) {\n      // console.log(res);\n      if (res.data) {\n        $('#training_edu_id').val(res.data.trainingEduId);\n        $('#edu_id').val(res.data.eduId);\n        window.alert('교육과정을 저장하였습니다.');\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  function deleteAssignment () {\n    if (!window.confirm('정말 삭제하시겠습니까?')) return false;\n\n    var params = {\n      id: assignmentId,\n      log_bind_user_id: $('#log_bind_user_id').val(),\n      edu_id: $('#edu_id').val()\n    };\n\n    window.axios.delete('/simple_assignment',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('배정내역을 삭제하지 못하였습니다.');\n        } else {\n          window.alert('교육과정을 삭제하였습니다.');\n          window.location.href = '/simple_assignment';\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 1. 교육 대상자 선택\n   */\n  function validateStep1 () {\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var data = null;\n\n    $('input[name=\\'upload_type\\']').val(currentTabId);\n\n    switch (currentTabId) {\n    case 'employee': // 등록된 직원\n      data = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n        return $(this).data('id');\n      }).get().join(', ');\n\n      if (!data) {\n        window.alert('직원을 선택하세요.');\n        return false;\n      }\n\n      $('input[name=\\'upload_employee_ids\\']').val(data);\n      break;\n\n    case 'excel': // 파일업로드\n      if (document.getElementById('UploadExcelFile').files.length === 0) {\n        $('#UploadExcelFile').focus();\n        window.alert('파일을 선택하세요.');\n        return false;\n      }\n      break;\n\n    default:\n      break;\n    }\n\n    return true;\n  }\n\n  /**\n   * 2. 교육과정 입력\n   */\n  function validateStep2 () {\n    var $eduName = $('input[name=\\'course_name\\']');\n    var $eduDescription = $('#input-course-desc').val(); // window.tinymce.activeEditor.getContent();\n\n    if ($eduName.val() === '') {\n      window.alert('교육과정명을 입력하세요.');\n      $eduName.focus();\n      return false;\n    }\n\n    if ($eduDescription === '') {\n      window.alert('교육과정에 대한 설명을 입력하세요.');\n      window.tinymce.execCommand('mceFocus', false, 'input-course-desc');\n      return false;\n    }\n\n    var pointIsValid = true;\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      // console.log('$(this).val()', checked, $(this).val());\n      if (checked) {\n        if ($(this).val() === '') {\n          window.alert($(this).prop('placeholder') + ' 포인트 점수를 입력하세요.');\n          $(this).focus();\n          pointIsValid = false;\n          return false;\n        } else {\n          pointTotal += parseInt($(this).val());\n        }\n      }\n    });\n\n    // console.log('pointTotal', pointTotal, pointIsValid);\n    if (!pointIsValid) return false;\n    if (pointTotal !== 100) {\n      window.alert('포인트의 합계는 100점이 되어야 합니다.');\n      return false;\n    }\n\n    return true;\n  }\n\n  $('.input-group-addon').children('input:checkbox').on('change', function () {\n    var input = $(this).parent().parent().find('.point-item');\n\n    input.prop('disabled', !$(this).prop('checked'));\n\n    if ($(this).prop('checked')) {\n      input.focus();\n    };\n  });\n\n  $('.point-item').on('keyup', _.debounce(function () {\n    var sum = 0;\n\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '' && $(this).val() !== '0') {\n        var point = parseInt($(this).val());\n        sum += point;\n      } else {\n        // $(this).prop('disabled', true);\n        // $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked', false);\n      }\n    });\n\n    if (sum > 0) {\n      $('.badge').text(sum);\n    }\n\n    if (sum > 100) {\n      window.alert('100점을 초과하였습니다.');\n      return false;\n    }\n  }, 300));\n\n  function getCourseView (data) {\n    return courseView(data);\n  }\n\n  function getSessionView (data) {\n    return sessionView(data);\n  }\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession (params) {\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          window.location.reload();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest (session) {\n    return window.axios({\n      method: 'put',\n      url: '/course/courselist',\n      data: {\n        title: session.children('a').data('title'),\n        course_list_id: session.children('a').data('id'),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder () {\n    var promises = [];\n    var items = window.$('.session-content > .list-group-item');\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises).then(function (results) {\n      results.forEach(function (response) {\n        console.log(response);\n      });\n    });\n  }\n\n  function toggleIcon (e) {\n    $(e.target)\n      .prev('.panel-heading')\n      .find('.more-less')\n      .toggleClass('glyphicon-plus glyphicon-minus');\n\n    // panel-group 에 현재 편집중인 강의 id 를 입력한다.\n    var $panelGroup = $(e.target).parents().find('.panel-group');\n    var selectedCourseId = $(e.target).parents().closest('.panel').data('id');\n\n    if ($panelGroup.data('selected-course-id') !== selectedCourseId) {\n      $panelGroup.data('selected-course-id', selectedCourseId);\n      getSessionList();\n    }\n  }\n\n  function addCourse () {\n    var $modal = $('#registerCourse');\n    var data = {\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      edu_id: $('#edu_id').val()\n    };\n\n    window.axios.post('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        if ($('#course-list').children().length === 0) {\n          var currSelector = 'ul.setup-panel li:eq(3)'; // 4. 메세지\n          $(currSelector).removeClass('disabled');\n          updateProgress(4);\n        }\n        $('#course-list').append(getCourseView(res.data));\n        $('.panel').last().data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function updateCourse () {\n    var $modal = $('#modifyCourse');\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var data = {\n      course_id: selectedCourseId,\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      course_rate: 0,\n      teacher_rate: 0\n    };\n\n    window.axios.put('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        // console.log(res.data);\n        $('.panel[data-id=' + res.data.course_id + ']').replaceWith(getCourseView(res.data));\n        $('.panel[data-id=' + res.data.course_id + ']').data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function onModifyCourseModalOpen (e) {\n    var data = $(e.relatedTarget).parents().find('.panel').data('metadata');\n    var $modal = $(this);\n\n    $modal.find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n    $modal.find('input[name=\\'course_name\\']').val(data.course_name);\n    $modal.find('input[name=\\'teacher_name\\']').val(data.teacher_name);\n    window.tinymce.get('course_desc').setContent(data.course_desc);\n    $modal.find('[autofocus]').focus();\n  }\n\n  $('#registerCourse').submit(function (e) {\n    e.preventDefault();\n\n    addCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n  $('#modifyCourse').submit(function (e) {\n    e.preventDefault();\n\n    updateCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n\n  $('.panel-group').on('hidden.bs.collapse', toggleIcon);\n  $('.panel-group').on('shown.bs.collapse', toggleIcon);\n  $('#registerCourse').on('hidden.bs.modal', function () {\n    $(this).find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n  });\n  $('#registerCourse').on('shown.bs.modal', function () {\n    $(this).find('[autofocus]').focus();\n  });\n  $('#modifyCourse').on('shown.bs.modal', onModifyCourseModalOpen);\n  // $('#modifyCourse').on('hidden.bs.modal', onModifyCourseModalClose);\n\n  // 비디오 생성하기\n  $('.panel-group').on('click', '.btn-create-video', function (e) {\n    e.preventDefault();\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/video?course_id=' + courseId, 'Video', windowOption);\n  });\n  // 퀴즈 생성하기\n  $('.panel-group').on('click', '.btn-create-quiz', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=QUIZ', 'Quiz', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-final', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=FINAL', 'Final', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-checklist', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/checklist?course_id=' + courseId + '&type=CHECK', 'Checklist', windowOption);\n  });\n  // 세션을 삭제한다.\n  $('.panel-group').on('click', '.btn-delete-session', function (e) {\n    e.preventDefault();\n\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var $self = $(this);\n    var params = {};\n    params.course_list_id = $(this).parent('span').data('course-list-id');\n    params.course_list_type = $(this).parent('span').data('type');\n\n    var courselistType = $(this).parent('span').data('type');\n    switch (courselistType) {\n    case 'QUIZ':\n    case 'FINAL':\n      params.quiz_group_id = $(this).data('quiz-group');\n      break;\n    case 'VIDEO':\n      params.video_id = $(this).data('video-id');\n      break;\n    case 'CHECKLIST':\n      params.checklist_group_id = $(this).data('checklist-group');\n      break;\n    default:\n      break;\n    }\n\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          $self.parents('li').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 세션 수정하기\n  $('.panel-group').on('click', '.btn-modify-session', function (e) {\n    e.preventDefault();\n\n    var dataCourseId = $(this).parent('span').data('course-id');\n    var dataCourseListId = $(this).parent('span').data('course-list-id');\n    var dataVideoId = $(this).data('video-id');\n    var dataQuizGroupId = $(this).data('quiz-group');\n    var dataChecklistGroupId = $(this).data('checklist-group');\n    var dataType = $(this).parent('span').data('type'); // VIDEO/QUIZ/FINAL\n\n    if (dataType === 'VIDEO') {\n      Util.createWindowPopup('/course/modify/video?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&video_id=' + dataVideoId, 'Video', windowOption);\n    } else if (dataType === 'QUIZ' || dataType === 'FINAL') {\n      Util.createWindowPopup('/course/modify/quiz?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&quiz_group_id=' + dataQuizGroupId, 'Quiz', windowOption);\n    } else if (dataType === 'CHECKLIST') {\n      Util.createWindowPopup('/course/modify/checklist?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&checklist_group_id=' + dataChecklistGroupId, 'Checklist', windowOption);\n    }\n  });\n\n  // 체크리스트 보기\n  $('.panel-group').on('click', '.btn-preview-checklist', function (e) {\n    e.preventDefault();\n    var courseListId = window.$(this).parent('span').data('course-list-id');\n    if (!courseListId) {\n      courseListId = window.$(this).data('id');\n    }\n    Util.createWindowPopup('/course/checklist?course_list_id=' + courseListId, 'Checklist', windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  $('.panel-group').on('click', '.btn-solve-quiz', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr('data-quiz-group');\n    var dataTitle = window.$(this).attr('data-title');\n    var dataType = window.$(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n\n  // 비디오 보기\n  $('.panel-group').on('click', '.btn-watch-video', function (e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr('data-video-id');\n    Util.createWindowPopup('/course/video?id=' + videoId, 'Video', windowOption);\n  });\n\n  $('.panel-group').on('click', '.btn-delete-course', function () {\n    if (window.confirm('선택하신 강의를 삭제하시겠습니까?')) {\n      var selectedCourseId = $('.panel-group').data('selected-course-id');\n\n      window.axios.delete('/course/deactivate', { params: { id: selectedCourseId } })\n      .then(function (res) {\n        if (res.data.success) {\n          $('.panel[data-id=' + selectedCourseId + ']').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n  });\n\n  btnSendMessage.on('click', function (e) {\n    e.preventDefault();\n\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var checkedEmployeeIds;\n    switch (currentTabId) {\n    case 'employee':\n      checkedEmployeeIds = window.$(':checkbox:checked',\n        tableEmployee.rows({filter: 'applied'}).nodes()).map(\n          function () {\n            return tableEmployee.row(window.$(this).parents('tr')).data()[4];\n          }\n        ).get().join(',');\n      break;\n    case 'employee-assigned':\n      // checkedEmployeeIds = window.$(':checkbox:checked',\n      //   tableAssignedEmployee.rows({filter: 'applied'}).nodes()).map(\n      //     function () {\n      //       return tableAssignedEmployee.row(window.$(this).parents('tr')).data()['user_phone'];\n      //     }\n      //   ).get().join(',');\n      break;\n    default:\n      break;\n    }\n\n    if (!checkedEmployeeIds) {\n      window.alert('직원을 선택하세요.');\n      return false;\n    }\n\n    var message = messageInput.val().trim();\n    if (message === '') {\n      window.alert('메세지를 입력하세요.');\n      messageInput.focus();\n      return false;\n    }\n\n    if (!window.confirm('메세지를 보내시겠습니까?')) {\n      return false;\n    }\n\n    window.axios({\n      method: 'post',\n      url: '/api/v1/sms/send',\n      data: {\n        phones: checkedEmployeeIds,\n        msg: message\n      }\n    })\n    .then(\n      function (res) {\n        if (res.data.success === true) {\n          window.alert('메세지를 전송하였습니다.');\n        } else {\n          window.alert('알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.');\n        }\n      });\n  });\n});\n"],"sourceRoot":"/source/"}