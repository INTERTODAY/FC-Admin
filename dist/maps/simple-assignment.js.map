{"version":3,"sources":["simple-assignment.js"],"names":["window","requirejs","activatedStep","sessionTemplate","sumPoint","pointTotal","$","tableEmployee","rows","filter","nodes","map","this","each","get","checked","val","employeeIds","parent","find","children","prop","parseInt","text","winpop_listener","$selectedPanel","data","sessionLoaded","selectedCourseId","undefined","connectWith","refresh","start","attr","res","update","html","getSessionView","session_list","sortable","removeAttr","changeSessionOrder","ui","item","index","e","disableSelection","catch","getCourseList","eduId","err","axios","then","tableCheckAll","bind","edu_course_list","last","$target","console","$item","activateStep","step","preventDefault","validateStep1","removeClass","saveStep1Data","updateProgress","post","id","assignmentId","formData","append","error","alert","FormData","document","getElementById","files","saveStep2Data","activeEditor","getContent","log","name","desc","tinymce","complete_point","quiz_point","test_point","reeltime_point","reps_point","start_dt","trainingEduId","edu_id","log_bind_user_id","can_replay","params","delete","response","deleteAssignment","confirm","success","location","href","currentTabId","join","$eduName","length","$eduDescription","focus","validateStep2","pointIsValid","execCommand","input","sum","sessionView","makeSessionOrderChangeRequest","session","results","title","course_list_id","course_list_order","$panelGroup","items","promises","push","$modal","course_name","toggleIcon","prev","toggleClass","currSelector","target","parents","getCourseView","updateCourse","course_id","course_desc","teacher_rate","teacher_name","course_rate","addCourse","replaceWith","onModifyCourseModalOpen","relatedTarget","end","setContent","navListItems","allWells","_","tableCourse","Util","initDataTable","lengthMenu","courseView","Handlebars","windowOption","messageInput","compile","courseTemplate","hide","initDateTimePicker","i","setEmployeeIds","getSessionList","addClass","click","activatedPanel","hasClass","closest","nextSelector","trigger","toString","on","btnDeleteSimpleAssign","btnSaveSimpleAssign","debounce","submit","createWindowPopup","modal","courseId","course_list_type","$self","dataCourseId","dataCourseListId","dataQuizGroupId","dataChecklistGroupId","courseListId","dataTitle","dataType","dataVideoId","videoId","quizGroupId","checkedEmployeeIds","remove","message","btnSendMessage","method","url","phones","trim","msg"],"mappings":"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","file":"simple-assignment.js","sourcesContent":["'use strict';\n\nwindow.requirejs([\n  'common',\n  'text!../course.template.html',\n  'text!../session.template.html'\n], function (Util, courseTemplate, sessionTemplate) {\n  var $ = undefined || window.$;\n  var _ = undefined || window._;\n  var assignmentId = $('#assignment_id').val();\n  var activatedStep = $('#activated_step').val();\n  var navListItems = $('ul.setup-panel li a');\n  var allWells = $('.setup-content');\n  var tableCheckAll = $('#check-all');\n  var tableCourse = Util.initDataTable($('#table_course'));\n  var tableEmployee = Util.initDataTable($('#table_employee'), {\n    'lengthMenu': [ [5, 10, 25, 50, -1], [5, 10, 25, 50, '전체'] ]\n    // 'columnDefs': [\n    //   { orderable: true, targets: [0] }\n    // ]\n  });\n  var btnDeleteSimpleAssign = $('#js-delete-simple-assign');\n  var btnSaveSimpleAssign = $('#js-save-simple-assign');\n  var btnSendMessage = $('.btn-send-message');\n  var messageInput = $('.message');\n  var courseView = window.Handlebars.compile(courseTemplate);\n  var sessionView = window.Handlebars.compile(sessionTemplate);\n  var windowOption = 'scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, resizable=yes, width=1040, height=760, left=0, top=0';\n\n  $(function () {\n    allWells.hide();\n\n    // DateTimePicker 설정\n    Util.initDateTimePicker(\n      $('.date#start_dt'),\n      $('.date#end_dt')\n    );\n\n    $('ul.setup-panel li').map(function () {\n      let $item = $(this);\n\n      for (var i = 2; i <= activatedStep; i++) {\n        if (i === $item.index() + 1) {\n          activateStep(i);\n        }\n      }\n    });\n\n    if ($('#edu_id').val()) {\n      getCourseList();\n    }\n\n    // 교육대상자 id 조회\n    setEmployeeIds();\n\n    sumPoint();\n  });\n\n  // 교육대상자 id 조회\n  function setEmployeeIds () {\n    var employeeIds = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n      return $(this).data('id');\n    }).get().join(', ');\n    $('input[name=\\'upload_employee_ids\\']').val(employeeIds);\n  }\n\n  function sumPoint () {\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '') {\n        pointTotal += parseInt($(this).val());\n      }\n    });\n\n    $('.badge').text(pointTotal);\n    return pointTotal;\n  }\n\n  /**\n   * 윈도우 팝업창에서의 저장 작업 완료 시 호출된다.\n   * @data: 갱신여부를 반환한다. true 일 경우 세션정보를 갱신한다.\n   */\n  window.winpop_listener = function (data) {\n    getSessionList(data);\n  };\n\n  /**\n   * 세션목록 조회\n   * 처음 강의를 열었을 때와 세션정보가 변경되는 경우만 세션 정보를 갱신한다.\n   */\n  function getSessionList (refresh) {\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var $selectedPanel = $('.panel[data-id=' + selectedCourseId + ']');\n\n    if ($selectedPanel.data('metadata').sessionLoaded === undefined || refresh) {\n      window.axios.get('/course/' + selectedCourseId)\n      .then(function (res) {\n        if (res.data) {\n          $selectedPanel.find('.session-content').html(getSessionView({ session_list: res.data.session_list }));\n          $selectedPanel.data('metadata').sessionLoaded = true;\n\n          $('.list-group').sortable({\n            connectWith: '.list-group-item',\n            start: function (e, ui) {\n              $(this).attr('data-previndex', ui.item.index());\n            },\n            update: function (e, ui) {\n              // var newIndex = ui.item.index();\n              // var oldIndex = window.$(this).attr('data-previndex');\n              // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n              $(this).removeAttr('data-previndex');\n              changeSessionOrder();\n            }\n          }).disableSelection();\n        }\n      })\n      .catch(function (err) {\n        console.log(err);\n      });\n    }\n  }\n\n  /**\n   * 강의목록 조회\n   */\n  function getCourseList () {\n    var eduId = $('#edu_id').val();\n\n    window.axios.get('/education/' + eduId + '/courses')\n    .then(function (res) {\n      if (res.data) {\n        $.each(res.data.edu_course_list, function (index, data) {\n          $('#course-list').append(getCourseView(data));\n          $('.panel').last().data('metadata', data);\n        });\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  tableCheckAll.bind('click', function () {\n    $(':checkbox', tableEmployee.rows().nodes()).prop('checked', this.checked);\n  });\n\n  navListItems.click(function (e) {\n    e.preventDefault();\n    var $target = $($(this).attr('href'));\n    var $item = $(this).closest('li');\n\n    if (!$item.hasClass('disabled')) {\n      navListItems.closest('li').removeClass('active');\n      $item.addClass('active');\n      allWells.hide();\n      $target.show();\n    }\n  });\n\n  if (activatedStep > 1) {\n    var activatedPanel = 'ul.setup-panel li a:eq(' + (activatedStep - 1).toString() + ')';\n    $(activatedPanel).click();\n  } else {\n    $('ul.setup-panel li.active a').trigger('click');\n  }\n\n  function activateStep (step) {\n    var currSelector = 'ul.setup-panel li:eq(' + (parseInt(step) - 1) + ')';\n    var nextSelector = 'ul.setup-panel li a[href=\"#step-' + step + '\"]';\n\n    $(currSelector).removeClass('disabled');\n    $(nextSelector).trigger('click');\n\n    // updateProgress(step);\n  }\n\n  // 1. 교육생 설정\n  $('.step1 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep1()) {\n      if (!window.confirm('저장하시겠습니까?')) return false;\n      activateStep(2);\n      saveStep1Data();\n    }\n  });\n  $('.step2 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(1);\n  });\n  // 2. 교육과정 개설\n  $('.step2 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    if (validateStep2()) {\n      if (!window.confirm('저장하시겠습니까?')) return false;\n      activateStep(3);\n      saveStep2Data();\n    }\n  });\n  $('.step3 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(2);\n  });\n  // 3. 강의 개설\n  $('.step3 > .next > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(4);\n    // updateProgress(3);\n  });\n  $('.step4 > .previous > a').on('click', function (e) {\n    e.preventDefault();\n    activateStep(3);\n  });\n\n  $('.panel-collapse').on('hide.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n  });\n\n  $('.panel-collapse').on('show.bs.collapse', function () {\n    $('.panel-collapse-clickable').find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n  });\n\n  btnDeleteSimpleAssign.on('click', deleteAssignment);\n  btnSaveSimpleAssign.on('click', function () {\n    // updateProgress($('ul.setup-panel li.active').index() + 1);\n    var step = $('ul.setup-panel li.active').index() + 1;\n\n    if (!window.confirm('저장하시겠습니까?')) return false;\n    switch (step) {\n    case 1:\n      if (validateStep1()) {\n        saveStep1Data();\n      }\n      break;\n    case 2:\n      if (validateStep2()) {\n        saveStep2Data();\n      }\n      break;\n    default:\n      break;\n    }\n  });\n\n  function updateProgress (step) {\n    window.axios.post('/simple_assignment/progress', {\n      step: step,\n      id: assignmentId\n    })\n    .then(function (response) {\n      activatedStep(step);\n      return true;\n    })\n    .catch(function (error) {\n      console.log(error);\n      return false;\n    });\n  }\n\n  /**\n   * 교육 대상자를 저장한다.\n   */\n  function saveStep1Data () {\n    var formData = new window.FormData();\n    formData.append('upload_type', $('input[name=\\'upload_type\\']').val());\n    formData.append('upload_employee_ids', $('input[name=\\'upload_employee_ids\\']').val());\n    formData.append('file-excel', document.getElementById('UploadExcelFile').files[0]);\n    formData.append('group_name', '간편배정');\n    formData.append('redirect', false);\n    formData.append('id', assignmentId);\n    formData.append('log_bind_user_id', $('#log_bind_user_id').val());\n\n    window.axios.post('/assignment/upload', formData)\n      .then(function (res) {\n        if (res.data) {\n          // $('input[name=\\'upload_employee_ids\\']').val(res.data.employeeIds);\n          $('#log_bind_user_id').val(res.data.logBindUserId);\n          window.alert('교육생을 저장하였습니다.');\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 교육과정 정보, 포인트 및 교육기간 정보를 저장한다.\n   */\n  function saveStep2Data () {\n    var data = {\n      'name': $('input[name=\\'course_name\\']').val(),\n      'desc': window.tinymce.activeEditor.getContent(),\n      'complete_point': $('input[name=\\'complete_point\\']').val(),\n      'quiz_point': $('input[name=\\'quiz_point\\']').val(),\n      'test_point': $('input[name=\\'test_point\\']').val(),\n      'reeltime_point': $('input[name=\\'reeltime_point\\']').val(),\n      'speed_point': $('input[name=\\'speed_point\\']').val(),\n      'reps_point': $('input[name=\\'reps_point\\']').val(),\n      'start_dt': $('input[name=\\'start_dt\\']').val(),\n      'finish_dt': $('input[name=\\'finish_dt\\']').val(),\n      'assigment_id': assignmentId,\n      'upload_employee_ids': $('input[name=\\'upload_employee_ids\\']').val(),\n      'edu_id': $('#edu_id').val(),\n      'log_bind_user_id': $('#log_bind_user_id').val(),\n      'training_edu_id': $('#training_edu_id').val(),\n      'can_replay': $('#can-replay').prop('checked') ? 1 : 0\n    };\n\n    // console.log(data);\n    // return false;\n\n    window.axios.post('/education', data)\n    .then(function (res) {\n      // console.log(res);\n      if (res.data) {\n        $('#training_edu_id').val(res.data.trainingEduId);\n        $('#edu_id').val(res.data.eduId);\n        window.alert('교육과정을 저장하였습니다.');\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n  }\n\n  function deleteAssignment () {\n    if (!window.confirm('정말 삭제하시겠습니까?')) return false;\n\n    var params = {\n      id: assignmentId,\n      log_bind_user_id: $('#log_bind_user_id').val(),\n      edu_id: $('#edu_id').val()\n    };\n\n    window.axios.delete('/simple_assignment',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('배정내역을 삭제하지 못하였습니다.');\n        } else {\n          window.alert('교육과정을 삭제하였습니다.');\n          window.location.href = '/simple_assignment';\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 1. 교육 대상자 선택\n   */\n  function validateStep1 () {\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var data = null;\n\n    $('input[name=\\'upload_type\\']').val(currentTabId);\n\n    switch (currentTabId) {\n    case 'employee': // 등록된 직원\n      data = $(':checkbox:checked', tableEmployee.rows({filter: 'applied'}).nodes()).map(function () {\n        return $(this).data('id');\n      }).get().join(', ');\n\n      if (!data) {\n        window.alert('직원을 선택하세요.');\n        return false;\n      }\n\n      $('input[name=\\'upload_employee_ids\\']').val(data);\n      break;\n\n    case 'excel': // 파일업로드\n      if (document.getElementById('UploadExcelFile').files.length === 0) {\n        $('#UploadExcelFile').focus();\n        window.alert('파일을 선택하세요.');\n        return false;\n      }\n      break;\n\n    default:\n      break;\n    }\n\n    return true;\n  }\n\n  /**\n   * 2. 교육과정 입력\n   */\n  function validateStep2 () {\n    var $eduName = $('input[name=\\'course_name\\']');\n    var $eduDescription = $('#input-course-desc').val(); // window.tinymce.activeEditor.getContent();\n\n    if ($eduName.val() === '') {\n      window.alert('교육과정명을 입력하세요.');\n      $eduName.focus();\n      return false;\n    }\n\n    if ($eduDescription === '') {\n      window.alert('교육과정에 대한 설명을 입력하세요.');\n      window.tinymce.execCommand('mceFocus', false, 'input-course-desc');\n      return false;\n    }\n\n    var pointIsValid = true;\n    var pointTotal = 0;\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      // console.log('$(this).val()', checked, $(this).val());\n      if (checked) {\n        if ($(this).val() === '') {\n          window.alert($(this).prop('placeholder') + ' 포인트 점수를 입력하세요.');\n          $(this).focus();\n          pointIsValid = false;\n          return false;\n        } else {\n          pointTotal += parseInt($(this).val());\n        }\n      }\n    });\n\n    console.log('pointTotal', pointTotal, pointIsValid);\n    if (!pointIsValid) return false;\n    if (pointTotal !== 100) {\n      window.alert('포인트의 합계는 100점이 되어야 합니다.');\n      return false;\n    }\n\n    return true;\n  }\n\n  $('.input-group-addon').children('input:checkbox').on('change', function () {\n    var input = $(this).parent().parent().find('.point-item');\n\n    input.prop('disabled', !$(this).prop('checked'));\n\n    if ($(this).prop('checked')) {\n      input.focus();\n    };\n  });\n\n  $('.point-item').on('keyup', _.debounce(function () {\n    var sum = 0;\n\n    $('.point-item').each(function () {\n      var checked = $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked');\n      if (checked && $(this).val() !== '' && $(this).val() !== '0') {\n        var point = parseInt($(this).val());\n        sum += point;\n      } else {\n        // $(this).prop('disabled', true);\n        // $(this).parent().find('.input-group-addon').children('input:checkbox').prop('checked', false);\n      }\n    });\n\n    if (sum > 0) {\n      $('.badge').text(sum);\n    }\n\n    if (sum > 100) {\n      window.alert('100점을 초과하였습니다.');\n      return false;\n    }\n  }, 300));\n\n  function getCourseView (data) {\n    return courseView(data);\n  }\n\n  function getSessionView (data) {\n    return sessionView(data);\n  }\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession (params) {\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          window.location.reload();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest (session) {\n    return window.axios({\n      method: 'put',\n      url: '/course/courselist',\n      data: {\n        title: session.children('a').data('title'),\n        course_list_id: session.children('a').data('id'),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder () {\n    var promises = [];\n    var items = window.$('.session-content > .list-group-item');\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises).then(function (results) {\n      results.forEach(function (response) {\n        console.log(response);\n      });\n    });\n  }\n\n  function toggleIcon (e) {\n    $(e.target)\n      .prev('.panel-heading')\n      .find('.more-less')\n      .toggleClass('glyphicon-plus glyphicon-minus');\n\n    // panel-group 에 현재 편집중인 강의 id 를 입력한다.\n    var $panelGroup = $(e.target).parents().find('.panel-group');\n    var selectedCourseId = $(e.target).parents().closest('.panel').data('id');\n\n    if ($panelGroup.data('selected-course-id') !== selectedCourseId) {\n      $panelGroup.data('selected-course-id', selectedCourseId);\n      getSessionList();\n    }\n  }\n\n  function addCourse () {\n    var $modal = $('#registerCourse');\n    var data = {\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      edu_id: $('#edu_id').val()\n    };\n\n    window.axios.post('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        if ($('#course-list').children().length === 0) {\n          var currSelector = 'ul.setup-panel li:eq(3)'; // 4. 메세지\n          $(currSelector).removeClass('disabled');\n          updateProgress(4);\n        }\n        $('#course-list').append(getCourseView(res.data));\n        $('.panel').last().data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function updateCourse () {\n    var $modal = $('#modifyCourse');\n    var selectedCourseId = $('.panel-group').data('selected-course-id');\n    var data = {\n      course_id: selectedCourseId,\n      course_name: $modal.find('input[name=\\'course_name\\']').val(),\n      course_desc: window.tinymce.activeEditor.getContent(),\n      teacher_name: $modal.find('input[name=\\'teacher_name\\']').val(),\n      course_rate: 0,\n      teacher_rate: 0\n    };\n\n    window.axios.put('/course', data)\n    .then(function (res) {\n      if (res.data) {\n        // console.log(res.data);\n        $('.panel[data-id=' + res.data.course_id + ']').replaceWith(getCourseView(res.data));\n        $('.panel[data-id=' + res.data.course_id + ']').data('metadata', res.data);\n      }\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function onModifyCourseModalOpen (e) {\n    var data = $(e.relatedTarget).parents().find('.panel').data('metadata');\n    var $modal = $(this);\n\n    $modal.find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n    $modal.find('input[name=\\'course_name\\']').val(data.course_name);\n    $modal.find('input[name=\\'teacher_name\\']').val(data.teacher_name);\n    window.tinymce.get('course_desc').setContent(data.course_desc);\n    $modal.find('[autofocus]').focus();\n  }\n\n  $('#registerCourse').submit(function (e) {\n    e.preventDefault();\n\n    addCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n  $('#modifyCourse').submit(function (e) {\n    e.preventDefault();\n\n    updateCourse();\n\n    window.tinymce.execCommand('mceFocus', false, 'course_desc');\n    $(this).modal('toggle');\n  });\n\n  $('.panel-group').on('hidden.bs.collapse', toggleIcon);\n  $('.panel-group').on('shown.bs.collapse', toggleIcon);\n  $('#registerCourse').on('hidden.bs.modal', function () {\n    $(this).find('input').val('').end();\n    window.tinymce.activeEditor.setContent('');\n  });\n  $('#registerCourse').on('shown.bs.modal', function () {\n    $(this).find('[autofocus]').focus();\n  });\n  $('#modifyCourse').on('shown.bs.modal', onModifyCourseModalOpen);\n  // $('#modifyCourse').on('hidden.bs.modal', onModifyCourseModalClose);\n\n  // 비디오 생성하기\n  $('.panel-group').on('click', '.btn-create-video', function (e) {\n    e.preventDefault();\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/video?course_id=' + courseId, 'Video', windowOption);\n  });\n  // 퀴즈 생성하기\n  $('.panel-group').on('click', '.btn-create-quiz', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=QUIZ', 'Quiz', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-final', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/quiz?course_id=' + courseId + '&type=FINAL', 'Final', windowOption);\n  });\n  // 파이널테스트 생성하기\n  $('.panel-group').on('click', '.btn-create-checklist', function (e) {\n    e.preventDefault();\n\n    var courseId = $(this).attr('data-course-id');\n    Util.createWindowPopup('/course/create/checklist?course_id=' + courseId + '&type=CHECK', 'Checklist', windowOption);\n  });\n  // 세션을 삭제한다.\n  $('.panel-group').on('click', '.btn-delete-session', function (e) {\n    e.preventDefault();\n\n    if (!window.confirm('삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?')) {\n      return false;\n    }\n\n    var $self = $(this);\n    var params = {};\n    params.course_list_id = $(this).parent('span').data('course-list-id');\n    params.course_list_type = $(this).parent('span').data('type');\n\n    var courselistType = $(this).parent('span').data('type');\n    switch (courselistType) {\n    case 'QUIZ':\n    case 'FINAL':\n      params.quiz_group_id = $(this).data('quiz-group');\n      break;\n    case 'VIDEO':\n      params.video_id = $(this).data('video-id');\n      break;\n    case 'CHECKLIST':\n      params.checklist_group_id = $(this).data('checklist-group');\n      break;\n    default:\n      break;\n    }\n\n    window.axios.delete('/course/courselist',\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert('진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.');\n        } else {\n          window.alert('세션을 삭제하였습니다.');\n          $self.parents('li').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 세션 수정하기\n  $('.panel-group').on('click', '.btn-modify-session', function (e) {\n    e.preventDefault();\n\n    var dataCourseId = $(this).parent('span').data('course-id');\n    var dataCourseListId = $(this).parent('span').data('course-list-id');\n    var dataVideoId = $(this).data('video-id');\n    var dataQuizGroupId = $(this).data('quiz-group');\n    var dataChecklistGroupId = $(this).data('checklist-group');\n    var dataType = $(this).parent('span').data('type'); // VIDEO/QUIZ/FINAL\n\n    if (dataType === 'VIDEO') {\n      Util.createWindowPopup('/course/modify/video?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&video_id=' + dataVideoId, 'Video', windowOption);\n    } else if (dataType === 'QUIZ' || dataType === 'FINAL') {\n      Util.createWindowPopup('/course/modify/quiz?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&quiz_group_id=' + dataQuizGroupId, 'Quiz', windowOption);\n    } else if (dataType === 'CHECKLIST') {\n      Util.createWindowPopup('/course/modify/checklist?course_id=' + dataCourseId + '&course_list_id=' + dataCourseListId + '&type=' + dataType + '&checklist_group_id=' + dataChecklistGroupId, 'Checklist', windowOption);\n    }\n  });\n\n  // 체크리스트 보기\n  $('.panel-group').on('click', '.btn-preview-checklist', function (e) {\n    e.preventDefault();\n    var courseListId = window.$(this).parent('span').data('course-list-id');\n    if (!courseListId) {\n      courseListId = window.$(this).data('id');\n    }\n    Util.createWindowPopup('/course/checklist?course_list_id=' + courseListId, 'Checklist', windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  $('.panel-group').on('click', '.btn-solve-quiz', function (e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr('data-quiz-group');\n    var dataTitle = window.$(this).attr('data-title');\n    var dataType = window.$(this).attr('data-type');\n\n    Util.createWindowPopup('/course/quiz?id=' + quizGroupId + '&title=' + dataTitle + '&type=' + dataType, 'Quiz', windowOption);\n  });\n\n  // 비디오 보기\n  $('.panel-group').on('click', '.btn-watch-video', function (e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr('data-video-id');\n    Util.createWindowPopup('/course/video?id=' + videoId, 'Video', windowOption);\n  });\n\n  $('.panel-group').on('click', '.btn-delete-course', function () {\n    if (window.confirm('선택하신 강의를 삭제하시겠습니까?')) {\n      var selectedCourseId = $('.panel-group').data('selected-course-id');\n\n      window.axios.delete('/course/deactivate', { params: { id: selectedCourseId } })\n      .then(function (res) {\n        if (res.data.success) {\n          $('.panel[data-id=' + selectedCourseId + ']').remove();\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n  });\n\n  btnSendMessage.on('click', function (e) {\n    e.preventDefault();\n\n    var currentTabId = $('ul.select-employee li.active').children().attr('id');\n    var checkedEmployeeIds;\n    switch (currentTabId) {\n    case 'employee':\n      checkedEmployeeIds = window.$(':checkbox:checked',\n        tableEmployee.rows({filter: 'applied'}).nodes()).map(\n          function () {\n            return tableEmployee.row(window.$(this).parents('tr')).data()[4];\n          }\n        ).get().join(',');\n      break;\n    case 'employee-assigned':\n      // checkedEmployeeIds = window.$(':checkbox:checked',\n      //   tableAssignedEmployee.rows({filter: 'applied'}).nodes()).map(\n      //     function () {\n      //       return tableAssignedEmployee.row(window.$(this).parents('tr')).data()['user_phone'];\n      //     }\n      //   ).get().join(',');\n      break;\n    default:\n      break;\n    }\n\n    if (!checkedEmployeeIds) {\n      window.alert('직원을 선택하세요.');\n      return false;\n    }\n\n    var message = messageInput.val().trim();\n    if (message === '') {\n      window.alert('메세지를 입력하세요.');\n      messageInput.focus();\n      return false;\n    }\n\n    if (!window.confirm('메세지를 보내시겠습니까?')) {\n      return false;\n    }\n\n    window.axios({\n      method: 'post',\n      url: '/api/v1/sms/send',\n      data: {\n        phones: checkedEmployeeIds,\n        msg: message\n      }\n    })\n    .then(\n      function (res) {\n        if (res.data.success === true) {\n          window.alert('메세지를 전송하였습니다.');\n        } else {\n          window.alert('알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.');\n        }\n      });\n  });\n});\n"],"sourceRoot":"/source/"}