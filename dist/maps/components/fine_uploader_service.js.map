{"version":3,"sources":["components/fine_uploader_service.js"],"names":["window","define","FineUploaderService","self","init","options","this","prototype","uploader","b","a","extend","key","hasOwnProperty","extendOptions","getUploadInfo","axios","response","data","uploadInfo","setFineUploader","uploadUrl","replace","uploadCancelUrl","token","autoUpload","cors","qq","FineUploaderBasic","expected","getElementById","el","validation","mutiple","allowedExtensions","itemLimit","stopOnFirstInvalidFile","request","endpoint","inputName","paramsInBody","folder","target_path","params","callbacks","onComplete","console","responseJSON","document","id","name","attach","uploadStoredFiles"],"mappings":"AAAA,YAEAA,QAAOC,QAIL,SAEA,QACA,mBAHA,iCAKA,SAASC,EAAAA,EAAAA,EAAAA,GAIPC,QAAKC,GAALC,GACDF,EAAAG,KAEDJ,EAAAA,cAAoBK,GAClBJ,EAAAC,OAPAD,GAAAA,GAHEK,CAiFJ,OApEIN,GAAgBO,WAEZC,WACDC,OAAA,SAAAD,EAAAD,GACF,IAAA,GAAAG,KAAAH,GACDA,EAAAI,eAAAD,KAT4BF,EAAAE,GAAAH,EAAAG,GAa5B,OAAKP,IAGPS,cAAA,SAAAT,GACAD,KAAMC,QAAAC,KAAYK,UAAAL,KAAAD,SAChBF,KAAKY,OAAAA,KAAAA,QAALV,IAGAW,KAAAA,WAEEb,EAAAY,iBAEEZ,cAAKE,WACLF,EAAAA,IAAKE,8BACLF,KAAAA,SAAAc,GAJF,GAAIC,GAAOD,EAASC,KAAKC,UAMvBD,KACAf,EAAKiB,QAAAA,UAALF,EAAAG,UAAAC,QAAA,KAAA,UACDnB,EAAAE,QAAAkB,gBAAAL,EAAAK,gBAVHpB,EAAAE,QAAAmB,MAAAN,EAAAM,MAcArB,EAAAiB,sBAIEK,gBAAY,WAEZC,EAAM,GAAAC,GAAAC,mBAEJC,QAAAA,SAAUC,eAAA3B,EAAAE,QAAA0B,IAFNN,YAL4B,EASlCO,SAAAA,EAAY3B,QAAA4B,QACVC,MACAC,UAAAA,EACAC,UAAAA,GAEFC,YACEC,mBAAejC,MAAQgB,OACvBkB,UAAW,EACXC,wBAHO,GAKLhB,SACAiB,SAAQtC,EAAAE,QAFFgB,UAGNqB,UAAAA,YAHMF,cAAA,EAlBwBG,QAwBlCC,MAAWzC,EAAAE,QAAAmB,MACTqB,OAAAA,OACEC,YAAYC,SA1BlBH,WA8BGI,WAASlB,SAATmB,EAAwBC,EAAAH,EAAkBI,GAC3C3C,QAAS4C,IAAAA,OADXzB,EAAGqB,SAASlB,eAAe,kBAAkBqB,OAAO,QAAS,WAMjE3C,EAAON,wBAAAA","file":"components/fine_uploader_service.js","sourcesContent":["'use strict';\n\nwindow.define([\n  'jquery',\n  'axios',\n  'fineUploaderCore', // fineUploader\n  'text!../../fine_uploader.html'\n], function ($, axios, qq, qqTemplate) {\n  var self;\n  var uploader;\n\n  function FineUploaderService (options) {\n    self = this;\n\n    self.extendOptions(options);\n    self.init();\n  }\n\n  FineUploaderService.prototype = {\n    // 옵션 저장 변수\n    options: {},\n    extend: function (a, b) {\n      for (var key in b) {\n        if (b.hasOwnProperty(key)) {\n          a[key] = b[key];\n        }\n      }\n      return a;\n    },\n    // 옵션 확장\n    extendOptions: function (options) {\n      this.options = this.extend({}, this.options);\n      this.extend(this.options, options);\n    },\n    // 컴포넌트 초기화\n    init: function () {\n      self.getUploadInfo();\n    },\n    getUploadInfo: function () {\n      axios.get('/api/v1/fineuploader/token')\n      .then(function (response) {\n        var data = response.data.uploadInfo;\n        if (data) {\n          self.options.uploadUrl = data.uploadUrl.replace('v4', 'cdnovp');\n          self.options.uploadCancelUrl = data.uploadCancelUrl;\n          self.options.token = data.token;\n\n          // console.log(self.options);\n          self.setFineUploader();\n        }\n      });\n    },\n    setFineUploader: function () {\n      // $('#uploader-template').append(qqTemplate);\n      uploader = new qq.FineUploaderBasic({\n      // uploader = new qq.FineUploader({\n        element: document.getElementById(self.options.el),\n        autoUpload: false,\n        multiple: self.options.mutiple,\n        cors: {\n          allowXdr: true,\n          expected: true\n        },\n        validation: {\n          allowedExtensions: ['avi', 'mp4'],\n          itemLimit: 3,\n          stopOnFirstInvalidFile: true\n        },\n        request: {\n          endpoint: self.options.uploadUrl,\n          inputName: 'videofile',\n          paramsInBody: false,\n          params: {\n            token: self.options.token,\n            folder: '/dev',\n            target_path: '/dev'\n          }\n        },\n        callbacks: {\n          onComplete: function (id, name, responseJSON, xhr) {\n            console.log(responseJSON);\n          }\n        }\n      });\n      qq(document.getElementById('upload-button')).attach('click', function () {\n        uploader.uploadStoredFiles();\n      });\n    }\n  };\n\n  return FineUploaderService;\n});\n"],"sourceRoot":"/source/"}