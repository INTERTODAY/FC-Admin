{"version":3,"sources":["components/aquaplayer_service.js"],"names":["window","define","self","Util","NplayerWrapperTemplate","AquaPlayerService","options","extend","a","b","key","hasOwnProperty","extendOptions","getEncodedParam","container","this","controlBox","visible","mode","html","initPlayer","initNPlayerUI","NPlayer","player","bindEvent","reportMessage","mygentAuthCall","setPlayerStart","genkey","encodedParam","fileUrl","url","getMediaURL","open","encodeURI","state","indicateUpdate","starthtml5State","OpenState","Opened","setVisible","Closed","PlayState","Playing","Stopped","Paused","name","desc","axios","ec","data","reportError","get","then","res","encparam","console","log","err","msg"],"mappings":"AAAA,YACAA,QAAOC,QAAPD,SAQE,qCACA,UACA,aALA,WAOA,gBACEE,SAAOC,EAAPC,GADF,QAASC,GAAmBC,GAO5BD,EAAAA,KAEEC,EAAAA,cAF4BA,GAG5BC,EAAAA,OAdF,GAOEL,GACAA,EAREA,EAAO,IA0HX,OAzGQM,GAASC,WAEZH,WACDC,OAAA,SAAAC,EAAAC,GAT0B,IAAA,GAAAC,KAAAD,GAW5BA,EAAAE,eAAAD,KACAE,EAAAA,GAAeH,EAAAC,GAZa,OAAAF,IAkB1BN,cAAKW,SAALP,GACAJ,KAAKI,QAAQQ,KAAAA,UAAeV,KAAAA,SAnBFW,KAAAR,OAAAQ,KAAAT,QAAAA,IAuBxBU,KAAAA,WACAC,EAAAA,kBACAC,EAAAA,QAAMJ,UAAAK,KAAAf,IAJVgB,WAAY,WAOVpB,EAAOqB,GAAAA,QAAPC,QAAA,SALEN,WAAY,uBAOdO,SAAOC,EACLtB,KAAKuB,UAGHzB,OAAAqB,cAAAE,GAEAA,EAAAC,UAAA,QAAA,WACAxB,EAAAA,cAAA,SAEAA,OAAAA,WAAO0B,WAJP1B,OAAO2B,gBAAe,GAQpBJ,OAAAA,WAAYA,GAAAvB,OAAZ0B,eAAA,SAAAE,GAJF5B,OAOG6B,aAPH3B,EAAAI,QAAAwB,QAAAF,EATJ,IAAAG,GAAA/B,OAAAgC,aAAA,EAaMT,GAAOU,MAONT,IAAAA,OAAUU,UAAAH,MAJVF,IAOL7B,OAAQmC,gBAARnC,OAAAoC,kBAGEpC,EAAAA,UAAOqC,mBAAP,SAAAF,GAGAnC,OAFAE,EAAAuB,cAAA,oBAEAzB,GACA,IAAAA,QAAAsB,QAAAgB,UAAAC,OAPFhB,EAAAiB,YAAA,GAHFxC,OAAAqC,iBAOI,MAOJd,KAAOC,QAAAA,QAAUc,UAAAG,OACfvC,OAAKuB,eAAczB,OAAAsB,QAAnBgB,UAAAG,WAKElB,EAAAC,UAAA,mBAAA,SAAAW,GAGAZ,OARFrB,EAAKuB,cAAc,oBAQjBF,GACA,IAAAvB,QAAAsB,QAAAoB,UAAAC,QALApB,EAAOiB,YAAW,EAOpB,MAEE,KAAAxC,QAAAsB,QAAAoB,UAAAE,QAXFrB,EAAAiB,YAAA,EAHF,MAkBAjB,KAAOC,QAAAA,QAAUkB,UAAjBG,OACE3C,EAAKuB,YAAc,MAKpBF,EAFDC,UAAA,gBAAA,SAAAsB,EAAAC,GAtF0B7C,EAAAuB,cAAA,mBAAAqB,EAAA,MAAAC,KA4F1B/C,EAAOgD,UAAU,QAAA,SAAAC,GAEbpB,EAAAA,cAAmBqB,WAAnBD,MAKA/C,gBAAKiD,WACNnD,OARHgD,MAAAI,IAAA,2BA5F0BC,KAAA,SAAAC,GAuG5B7B,EAAe6B,EAAAJ,KAAAK,SACbC,EAAQC,cAAI5B,GAxGc3B,EAAAkB,eA2G1BoC,MAAQC,SAAIC,GACbxD,EAAAiD,YAAAO,MA/HLjC,cAAA,SAAAkC,GA2HMH,QAAQC,IAAI,iBAAmBE,IAEjCR,YAAa,SAAUO,GACrBF,QAAQC,IAAI,iBAAmBC,KAI5BrD","file":"components/aquaplayer_service.js","sourcesContent":["'use strict';\nwindow.define([\n  'common',\n  'text!../../../nplayer_wrapper.html',\n  'nplayer',\n  'nplayer_ui',\n  'cdnproxy',\n  'nplayer_conf'\n], function (Util, NplayerWrapperTemplate) {\n  var self = null;\n  var encodedParam;\n  var player;\n\n  function AquaPlayerService (options) {\n    self = this;\n\n    self.extendOptions(options);\n    self.init();\n  }\n\n  AquaPlayerService.prototype = {\n    // 옵션 저장 변수\n    options: {},\n    extend: function (a, b) {\n      for (var key in b) {\n        if (b.hasOwnProperty(key)) {\n          a[key] = b[key];\n        }\n      }\n      return a;\n    },\n    // 옵션 확장\n    extendOptions: function (options) {\n      this.options = this.extend({}, this.options);\n      this.extend(this.options, options);\n    },\n    // 컴포넌트 초기화\n    init: function () {\n      self.getEncodedParam();\n      self.options.container.html(NplayerWrapperTemplate);\n    },\n    initPlayer: function () {\n      player = new window.NPlayer('video', {\n        controlBox: 'nplayer_control.html',\n        visible: false,\n        mode: 'html5'\n      });\n\n      window.initNPlayerUI(player);\n\n      player.bindEvent('Ready', function () {\n        self.reportMessage('ready');\n\n        window.proxy_init(function () {\n          // 1. video start set\n          window.setPlayerStart(true);\n          // 2. nplayer instance set\n          window.setNPlayer(player);\n          // 4. media info set\n          window.mygentAuthCall(function (genkey) {\n            window.setMediaInfo(self.options.fileUrl, genkey);\n\n            var url = window.getMediaURL(false);\n            player.open({\n              'URL': window.encodeURI(url)\n            });\n          }, encodedParam);\n        }, window.indicateInstall, window.indicateUpdate);\n      });\n\n      player.bindEvent('OpenStateChanged', function (state) {\n        self.reportMessage('OpenStateChanged');\n\n        switch (state) {\n        case window.NPlayer.OpenState.Opened:\n          player.setVisible(true);\n          window.starthtml5State();\n          break;\n        case window.NPlayer.OpenState.Closed:\n          window.Stophtml5State(window.NPlayer.OpenState.Closed);\n          break;\n        }\n      });\n\n      player.bindEvent('PlayStateChanged', function (state) {\n        self.reportMessage('PlayStateChanged');\n\n        switch (state) {\n        case window.NPlayer.PlayState.Playing:\n          player.setVisible(true);\n          break;\n\n        case window.NPlayer.PlayState.Stopped:\n          player.setVisible(false);\n          break;\n\n        case window.NPlayer.PlayState.Paused:\n          player.setVisible(true);\n          break;\n        }\n      });\n\n      player.bindEvent('GuardCallback', function (name, desc) {\n        self.reportMessage('GuardCallback - ' + name + ' : ' + desc);\n      });\n\n      player.bindEvent('Error', function (ec) {\n        self.reportMessage('Error - ' + ec);\n      });\n    },\n    // encparam 을 서버에서 생성하여 전달받는다.\n    getEncodedParam: function () {\n      window.axios.get('/api/v1/player/encparam')\n        .then(function (res) {\n          encodedParam = res.data.encparam;\n          self.reportMessage(encodedParam);\n          self.initPlayer();\n        })\n        .catch(function (err) {\n          self.reportError(err);\n        }\n      );\n    },\n    reportMessage: function (msg) {\n      console.log('aquaservice : ' + msg);\n    },\n    reportError: function (err) {\n      console.log('aquaservice : ' + err);\n    }\n  };\n\n  return AquaPlayerService;\n});\n"],"sourceRoot":"/source/"}