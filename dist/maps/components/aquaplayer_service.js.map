{"version":3,"sources":["components/aquaplayer_service.js"],"names":["window","define","AquaPlayerService","options","self","this","extendOptions","encodedParam","hasOwnProperty","extend","a","b","key","init","getEncodedParam","controlBox","visible","initPlayer","player","NPlayer","initNPlayerUI","bindEvent","setPlayerStart","reportMessage","proxy_init","url","mygentAuthCall","genkey","setMediaInfo","fileUrl","indicateInstall","open","URL","encodeURI","indicateUpdate","setVisible","state","starthtml5State","Stophtml5State","OpenState","Closed","Playing","Stopped","PlayState","Paused","ec","name","desc","axios","reportError","then","res","data","encparam","console","log","err","msg"],"mappings":"AAAA,YACAA,QAAOC,QAAPD,SAOE,UACA,aACA,WAJA,gBAMA,SAASE,GAKR,QAAAA,GAAAC,GAJCC,EAAOC,KAOPD,EAAAE,cAAAH,GACAA,EAAAA,OARAC,GAJEG,GAMFH,EAFAA,EAAO,IAoHT,OAzGMF,GAAMM,WAELL,WACFM,OAAA,SAAAC,EAAAC,GACD,IAAA,GAAAC,KAAAD,GAT0BA,EAAAH,eAAAI,KAW5BF,EAAAE,GAAAD,EAAAC,GAGE,OAAKH,IAGPI,cAAM,SAAYV,GAChBC,KAAKU,QAAAA,KAALL,UAAAJ,KAAAF,SAlB0BE,KAAAI,OAAAJ,KAAAF,QAAAA,IAsBxBY,KAAAA,WACAC,EAAAA,mBAFmCC,WAArC,WAAAC,EAAS,GAAIlB,QAAOmB,QAAQ,SAM5BnB,WAAOoB,uBAJLJ,SAAS,EAMXE,KAAOG,UAGLrB,OAAAA,cAAkBkB,GAEhBlB,EAAAA,UAAOsB,QAAe,WACtBlB,EAAAmB,cAAA,SAEAvB,OAAAwB,WAAA,WAEExB,OAAAA,gBAAoBI,GAEpBJ,OAAIyB,WAAMzB,GAERA,OAAA0B,eAAiBD,SAAVE,GADG3B,OAAZ4B,aAAAxB,EAAAD,QAAA0B,QAAAF,EAID3B,IAAAA,GAAO8B,OAAAA,aAAiB9B,EAjB7BkB,GAAAa,MAcQC,IAAOC,UAAUR,MAOlBF,IAJFvB,OAAO8B,gBAAiB9B,OAAOkC,kBAQhChB,EAAAA,UAAOiB,mBAAP,SAAAC,GAGF,OAFEpC,EAAAA,cAAOqC,oBAEJrC,GACHA,IAAAA,QAAOsC,QAAAA,UAAetC,OACtBkB,EAAAiB,YAAA,GAPFnC,OAAAqC,iBAHF,MAQE,KAAKrC,QAAOmB,QAAQoB,UAAUC,OAMhCtB,OAAOG,eAAUrB,OAAAmB,QAAoBoB,UAAUH,WAK3ClB,EAAAA,UAAOiB,mBAAP,SAAAC,GAGF,OAFEhC,EAAAmB,cAAA,oBAEGvB,GACHkB,IAAAA,QAAOiB,QAAAA,UAAPM,QACAvB,EAAAiB,YAAA,EAJA,MAOAjB,KAAAA,QAAOiB,QAAAA,UAAPO,QACAxB,EAAAiB,YAAA,EAXF,MASA,KAAKnC,QAAOmB,QAAQwB,UAAUC,OAMhC1B,EAAOG,YAAU,MAKfjB,EAAKmB,UAAAA,gBAA2BsB,SAAhCC,EAAAC,GADF3C,EAAAmB,cAAA,mBAAAuB,EAAA,MAAAC,KAKFjC,EAAAA,UAAiB,QAAA,SAAA+B,GACf7C,EAAOgD,cAAU,WAAAH,MAKd/B,gBACM,WACLV,OAAK6C,MAAAA,IAAAA,2BAPTC,KAAA,SAAAC,GA3F0B5C,EAAA4C,EAAAC,KAAAC,SAsG5B9B,EAAAA,cAAehB,GACb+C,EAAQC,eAEVN,MAAAA,SAAaO,GACXF,EAAQC,YAAIC,MAIhBjC,cAAOrB,SAAPuD,GAhIFH,QAAAC,IAAA,iBAAAE,IA2HIR,YAAa,SAAUO,GACrBF,QAAQC,IAAI,iBAAmBC,KAI5BtD","file":"components/aquaplayer_service.js","sourcesContent":["'use strict';\nwindow.define([\n  'common',\n  'nplayer',\n  'nplayer_ui',\n  'cdnproxy',\n  'nplayer_conf'\n], function (Util) {\n  var self = null;\n  var encodedParam;\n  var player;\n\n  function AquaPlayerService (options) {\n    self = this;\n\n    self.extendOptions(options);\n    self.init();\n  }\n\n  AquaPlayerService.prototype = {\n    // 옵션 저장 변수\n    options: {},\n    extend: function (a, b) {\n      for (var key in b) {\n        if (b.hasOwnProperty(key)) {\n          a[key] = b[key];\n        }\n      }\n      return a;\n    },\n    // 옵션 확장\n    extendOptions: function (options) {\n      this.options = this.extend({}, this.options);\n      this.extend(this.options, options);\n    },\n    // 컴포넌트 초기화\n    init: function () {\n      self.getEncodedParam();\n    },\n    initPlayer: function () {\n      player = new window.NPlayer('video', {\n        controlBox: 'nplayer_control.html',\n        visible: false,\n        mode: 'html5'\n      });\n\n      window.initNPlayerUI(player);\n\n      player.bindEvent('Ready', function () {\n        self.reportMessage('ready');\n\n        window.proxy_init(function () {\n          // 1. video start set\n          window.setPlayerStart(true);\n          // 2. nplayer instance set\n          window.setNPlayer(player);\n          // 4. media info set\n          window.mygentAuthCall(function (genkey) {\n            window.setMediaInfo(self.options.fileUrl, genkey);\n\n            var url = window.getMediaURL(false);\n            player.open({\n              'URL': encodeURI(url)\n            });\n          }, encodedParam);\n        }, window.indicateInstall, window.indicateUpdate);\n      });\n\n      player.bindEvent('OpenStateChanged', function (state) {\n        self.reportMessage('OpenStateChanged');\n\n        switch (state) {\n        case window.NPlayer.OpenState.Opened:\n          player.setVisible(true);\n          window.starthtml5State();\n          break;\n        case window.NPlayer.OpenState.Closed:\n          window.Stophtml5State(window.NPlayer.OpenState.Closed);\n          break;\n        }\n      });\n\n      player.bindEvent('PlayStateChanged', function (state) {\n        self.reportMessage('PlayStateChanged');\n\n        switch (state) {\n        case window.NPlayer.PlayState.Playing:\n          player.setVisible(true);\n          break;\n\n        case window.NPlayer.PlayState.Stopped:\n          player.setVisible(false);\n          break;\n\n        case window.NPlayer.PlayState.Paused:\n          player.setVisible(true);\n          break;\n        }\n      });\n\n      player.bindEvent('GuardCallback', function (name, desc) {\n        self.reportMessage('GuardCallback - ' + name + ' : ' + desc);\n      });\n\n      player.bindEvent('Error', function (ec) {\n        self.reportMessage('Error - ' + ec);\n      });\n    },\n    // encparam 을 서버에서 생성하여 전달받는다.\n    getEncodedParam: function () {\n      window.axios.get('/api/v1/player/encparam')\n        .then(function (res) {\n          encodedParam = res.data.encparam;\n          self.reportMessage(encodedParam);\n          self.initPlayer();\n        })\n        .catch(function (err) {\n          self.reportError(err);\n        }\n      );\n    },\n    reportMessage: function (msg) {\n      console.log('aquaservice : ' + msg);\n    },\n    reportError: function (err) {\n      console.log('aquaservice : ' + err);\n    }\n  };\n\n  return AquaPlayerService;\n});\n"],"sourceRoot":"/source/"}